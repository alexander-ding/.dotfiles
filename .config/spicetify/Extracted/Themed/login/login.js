(()=>{var e,t={7821:e=>{e.exports={af:"af-ZA",am:"am-ET",ar:"ar",az:"az-AZ",bg:"bg-BG",bn:"bn-IN",bho:"bp",cs:"cs-CZ",da:"da-DK",de:"de-DE",el:"el-GR",es:"es-ES","es-419":"es-LA",et:"et-EE",fa:"fa-IR",fr:"fr-FR",fi:"fi-FI",fil:"fp-PH","fr-CA":"fr-CA",gu:"gu-IN",hu:"hu-HU",he:"he-IL",hi:"hi-IN",hr:"hr-HR",id:"id-ID",is:"is-IS",it:"it-IT",ja:"ja-JP",kn:"kn-IN",ko:"ko-KR",lt:"lt-LT",lv:"lv-LV",ml:"ml-IN",mr:"mr-IN",ms:"ms-MY",nb:"nb-NO",ne:"ne-NP",nl:"nl-NL",or:"or-IN","pa-IN":"pa-IN","pa-PK":"pa-PK",pl:"pl-PL","pt-PT":"pt-PT","pt-BR":"pt-BR",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",sr:"sr-RS",sv:"sv-SE",sw:"sw",ta:"ta-IN",te:"te-IN",th:"th-TH",tr:"tr-TR",uk:"uk-UA",ur:"ur",vi:"vi-VN","zh-CN":"zh-CN","zh-TW":"zh-TW",zu:"zu-ZA","ar-EG":"ar-EG","ar-MA":"ar-MA","ar-SA":"ar-SA",eu:"eu-ES",bs:"bs-BA",ca:"ca-ES","zh-HK":"zh-HK","en-GB":"en-GB",gl:"gl-ES",mk:"mk-MK","es-AR":"es-AR","es-MX":"es-MX"}},8808:(e,t,s)=>{"use strict";var n={};s.r(n),s.d(n,{ABORT_LOGIN_TYPE_ACCOUNTS:()=>A,ACCOUNTS_METHODS:()=>P,LOADING:()=>v,LOGIN_BEFORE:()=>E,LOGIN_CLEAR_ERRORS:()=>w,LOGIN_FAIL:()=>C,LOGIN_SUCCESS:()=>k,LOGIN_TYPE_ACCOUNTS:()=>N,LOGIN_TYPE_AUTOLOGIN:()=>I,LOGIN_TYPE_EMAIL:()=>T,UTM_PARAMETERS:()=>x,abortLoginWithAccounts:()=>U,fetchUTMParameters:()=>G,loading:()=>O,login:()=>j,loginClearErrors:()=>H,loginFailed:()=>M,loginSuccess:()=>F,loginWithAccounts:()=>R,receivedUTMParameters:()=>B});var r={};s.r(r),s.d(r,{ENTER_LOGIN_MODE:()=>Y,ENTER_SETTINGS_MODE:()=>z,ENTER_SIGNUP_MODE:()=>V,ENTER_SIGNUP_MODE_STEP_0:()=>$,ENTER_SIGNUP_MODE_STEP_1:()=>K,ENTER_WELCOME_MODE:()=>q,INTERACTION:()=>J,START_APP:()=>W,enterLoginMode:()=>te,enterSettingsMode:()=>ne,enterSignupMode:()=>Z,enterSignupModeStep0:()=>Q,enterSignupModeStep1:()=>ee,enterWelcomeMode:()=>se,interaction:()=>oe,openSignupPage:()=>re,startApp:()=>X});var o={};s.r(o),s.d(o,{CLEAR_ALL_ERRORS:()=>Ie,COUNTRY_NOT_LAUNCHED:()=>Te,FACEBOOK_SIGNUP_ATTEMPT:()=>ye,FACEBOOK_SIGNUP_FAILURE:()=>ke,FACEBOOK_SIGNUP_SUCCESS:()=>Ee,SIGNUP_ATTEMPT:()=>fe,SIGNUP_FAILURE:()=>be,SIGNUP_RESTRICTIONS_FAILURE:()=>_e,SIGNUP_RESTRICTIONS_SUCCESS:()=>me,SIGNUP_SUCCESS:()=>Se,UPDATE_SIGNUP_DATA:()=>xe,VALIDATE_FIELD_ATTEMPT:()=>we,VALIDATE_FIELD_FAILURE:()=>Ce,VALIDATE_FIELD_SUCCESS:()=>ve,clearAllErrors:()=>Ke,countryNotLaunched:()=>$e,facebookSignup:()=>Re,facebookSignupFailure:()=>Ge,facebookSignupSuccess:()=>Ue,getSignupRestrictions:()=>Ne,signup:()=>De,signupAttempt:()=>Me,signupFailure:()=>Le,signupRestrictionsFailure:()=>Pe,signupRestrictionsSuccess:()=>Ae,signupSuccess:()=>Oe,signupWithAccounts:()=>je,updateSignupData:()=>Ve,validateField:()=>Fe,validateFieldAttempt:()=>Be,validateFieldFailure:()=>He,validateFieldSuccess:()=>We});var i={};s.r(i),s.d(i,{SETTINGS_FETCH_PROXY_SETTINGS_FAILURE:()=>dt,SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS:()=>lt,SETTINGS_RESTART_CLIENT_FAILURE:()=>ht,SETTINGS_RESTART_CLIENT_SUCCESS:()=>pt,SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE:()=>ut,SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS:()=>ct,fetchProxySettings:()=>gt,restartClient:()=>_t,updateProxySettings:()=>mt});var a=s(7995),l=s(3742),d=s(641),c=s(9663),u=s(3688);const p=e=>s.g&&"function"==typeof s.g._getSpotifyModule?new Promise(((t,n)=>{s.g._getSpotifyModule("bridge").executeRequest(JSON.stringify(e),{onSuccess:t,onFailure:n})})):null,h=window.localStorage,g="lastUsername",m="THIS_USER_DOES_NOT_EXIST_AND_IS_A_PLACEHOLDER",_="utmParameters",f=h.getItem(_),b=h.getItem(g),S={errorData:null,loginInProgress:!1,redirectTo:null,username:b!==m?b:"",utmParameters:f?JSON.parse(f):null};const y=function(e=S,t){switch(t.type){case ft.LOADING:return{...e,loading:!0,throbberDelay:t.throbberDelay};case ft.LOGIN_FAIL:return{...e,loading:!1,errorData:t.errorData,loggedIn:!1,loginInProgress:!1};case ft.LOGIN_BEFORE:return{...e,errorData:t.errorData,loggedIn:!1,loginInProgress:t.loginInProgress,username:t.username};case ft.LOGIN_SUCCESS:return{...e,loading:!1,loggedIn:!0,redirectDelay:t.redirectDelay||0,redirectTo:t.redirectTo,username:t.username};case ft.UTM_PARAMETERS:return{...e,utmParameters:t.utmParameters};case ft.LOGIN_CLEAR_ERRORS:return{...e,errorData:null};default:return e}},E="LOGIN_BEFORE",k="LOGIN_SUCCESS",w="LOGIN_CLEAR_ERRORS",C="LOGIN_FAIL",v="LOADING",x="UTM_PARAMETERS",T="login",I="autologin",N="login-accounts",A="abort-login-accounts",P={facebook:"facebook",apple:"apple",google:"google"};function D(e,t=T){return{type:E,errorData:null,username:e||"",loginInProgress:t===T,loginType:t}}function F(e,t,s=T,n=!1,r){return{type:k,errorData:null,redirectTo:r,redirectDelay:t||0,username:e,loginType:s,afterSignup:n}}function M(e,t=T){return{type:C,errorData:e,loginType:t}}function O(e){return{type:v,throbberDelay:e&&e.throbberDelay?e.throbberDelay:0}}const L=async(e,t,{defaultErrorCode:s,redirectDelay:n=0}={},r=T,o=!1,i=null,a=!0)=>{i&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=i);try{const s=JSON.parse(await p(t)).redirectTo||"xpui";let i=null;t&&t.args&&t.args[0]&&(i=t.args[0].username),e(F(a?i:m,n,r,o,s))}catch(t){let n=t;s?n={errorCode:s}:"string"==typeof t&&(n=JSON.parse(t)),e(M(n,r))}};function j({username:e,password:t,rememberMe:s},n=!1,r=null){return o=>{const i=n?I:T;o(D(s?e:m,i));L(o,{name:T,args:[{username:e,password:t,rememberMe:s}]},{redirectDelay:200},i,n,r,s)}}function R(e,t){return s=>{s(D(null,N));L(s,{name:N,args:[{method:e,enableSignup:!1}]},{redirectDelay:200},N,!1,t)}}function U(){return async()=>{await p({name:A,args:[]})}}function G(){return async e=>{e(B(JSON.parse(await p({name:"get-signup-utm-parameters",args:[]}))))}}function B(e){return{type:x,utmParameters:e}}function H(){return{type:w}}const W="START_APP",V="ENTER_SIGNUP_MODE",$="ENTER_SIGNUP_MODE_STEP_0",K="ENTER_SIGNUP_MODE_STEP_1",Y="ENTER_LOGIN_MODE",q="ENTER_WELCOME_MODE",z="ENTER_SETTINGS_MODE",J="INTERACTION";function X(){return{type:W}}function Z(e=null){return{type:V,actionHash:e}}function Q(){return{type:$}}function ee(){return{type:K}}function te(e=null){return{type:Y,actionHash:e}}function se(e=null){return{type:q,errorMessage:e}}function ne(){return{type:z}}function re(e=!1){return async(t,s)=>{let n,r={};switch(e?"website":"desktop-app"){case"desktop-app":t(Z());break;case"website":{await t(G());const e=s();r=e.login.utmParameters||{utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""};const o=Object.keys(r).reduce(((e,t)=>(e[t]=encodeURIComponent(r[t]),e)),{});n=`https://www.spotify.com/signup?utm_source=${o.utm_source}&utm_medium=${o.utm_medium}&utm_campaign=${o.utm_campaign}`,o.referral&&(n+=`&referral=${o.referral}&referrer=${o.referral}`),window.open(n);break}}}}function oe(e,t,s,n,r){return{type:J,page:e,interactionType:t,intent:s,itemId:n,actionHash:r}}var ie=s(8961),ae=s.n(ie);function le(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.DESKTOP_SIGNUP_DEBUG_KEY;return e||"4c7a36d5260abca4af282779720cf631"}function de(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.client_version||"";if(!e)throw new Error("Missing Spotify App Version! Something is wrong: talk to #desktop-squad.");return["Spotify-App-Version",e]}function ce(){const e="undefined"!=typeof window&&window.navigator&&window.navigator.platform||"";let t="";if(-1!==e.indexOf("Mac")?t="OSX":-1!==e.indexOf("Win")?t="Win32":-1!==e.indexOf("Linux")&&(t="Linux"),!t)throw new Error("Missing App Platform! Something is wrong: talk to #desktop-squad.");return["App-Platform",t]}function ue(e){const t=new Map(Object.entries(e).sort()),s=function(e){const t=ae().create();return e.forEach((e=>{void 0!==e&&t.update(e.toString())})),t.hex()}(t);if(t.size>s.length)return t;const n=[...t],r=[...Array(t.size).keys()].sort((function(e,t){const r=s.charAt(e).localeCompare(s.charAt(t));return 0!==r?r:n[e][0].localeCompare(n[t][0])})),o=new Map;return r.forEach((function(e){o.set(n[e][0],n[e][1])})),o}const pe=e=>async(t,s,n)=>{const r=function({name:e,email:t,password:s,gender:n,birthDate:r={},sendEmail:o,shareData:i,agreeEula:a}={},l={utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""},d=!1){const c=Object.keys(l).reduce(((e,t)=>(e[t]=encodeURIComponent(l[t]),e)),{});let u=`https://login.app.spotify.com?utm_source=${c.utm_source}&utm_medium=${c.utm_medium}&utm_campaign=${c.utm_campaign}`;c.referral&&(u+=`&referral=${c.referral}&referrer=${c.referral}`);const p={key:le(),displayname:e,email:t,password:s,password_repeat:s,gender:n,birth_year:r.year,birth_month:r.month,birth_day:r.day,iagree:a?1:0,creation_point:u,creation_flow:"desktop",platform:"desktop",referrer:c.referral};return"boolean"==typeof o&&(p["send-email"]=o),"boolean"==typeof i&&(p.thirdpartyemail=i),d&&Object.keys(p).forEach((e=>{void 0===p[e]&&delete p[e]})),ue(p)}(t,s,n),o=new FormData;r.forEach(((e,t)=>{o.append(t,e)}));const i=[de(),ce()].reduce(((e,t)=>(e[t[0]]=t[1],e)),{}),a={method:"POST",body:o,headers:{"App-Platform":i["App-Platform"],"Spotify-App-Version":i["Spotify-App-Version"],"X-Client-Id":{}.SPOTIFY_CLIENT_ID}},l=new Request(e,a);((e,t)=>{const s=e.headers.get("content-type");e.headers.set("content-type",((e,t)=>[...e.split(";"),t].join(";"))(s,t))})(l,"charset=utf-8");const d=await fetch(l),{errors:c,...u}=await d.json()||{};if(c)throw c;return u},he=pe("https://spclient.wg.spotify.com/signup/public/v1/account/"),ge=pe("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=true");const me="SIGNUP_RESTRICTIONS_SUCCESS",_e="SIGNUP_RESTRICTIONS_FAILURE",fe="SIGNUP_ATTEMPT",be="SIGNUP_FAILURE",Se="SIGNUP_SUCCESS",ye="FACEBOOK_SIGNUP_ATTEMPT",Ee="FACEBOOK_SIGNUP_SUCCESS",ke="FACEBOOK_SIGNUP_FAILURE",we="VALIDATE_FIELD_ATTEMPT",Ce="VALIDATE_FIELD_FAILURE",ve="VALIDATE_FIELD_SUCCESS",xe="UPDATE_SIGNUP_DATA",Te="COUNTRY_NOT_LAUNCHED",Ie="CLEAR_ALL_ERRORS";function Ne(){return async(e,t)=>{const s=t();try{e(Ae(window.__spotify&&!0===window.__spotify.is_running_on_teamcity?{}:await(async()=>{const e=await fetch("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=1"),t=await e.json()||{};if(t.errors&&t.errors.length>0)throw t.errors;return t})()))}catch(t){e(Pe(t)),s.app&&s.app.mode&&"welcome"!==s.app.mode&&(e(te()),e(re(!0)))}}}function Ae(e){return{type:me,restrictions:e}}function Pe(e){return{type:_e,error:e}}function De(e=null){return async(t,s)=>{t(Me()),await t(G());const n=s().signup.formData,r=s().login.utmParameters;try{await he(n,r),t(Oe());const{email:s,password:o}=n;t(j({username:s,password:o,rememberMe:!0},!0,e))}catch(e){const s={};Object.keys(e).forEach((t=>{s["birthdate"===t?"birthDate":t]={message:e[t]}})),t(Le(s))}}}function Fe(e){return async(t,s)=>{await t(G());const n=s().signup.formData[e],r=s().login.utmParameters;t(Be(e,n));try{await ge({[e]:n},r,!0)}catch(s){s[e]&&t(He(e,{message:s[e]}))}}}function Me(){return{type:fe}}function Oe(){return{type:Se}}function Le(e){return{type:be,errors:e}}function je(e,t=null){return s=>{const n={name:N,args:[{method:e,enableSignup:!0}]};s(Re()),(async(e,t,s=null)=>{s&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=s);try{const s=JSON.parse(await p(t)).redirectTo||"xpui";e(Ue()),e(F(null,0,I,!0,s))}catch(t){let s=t;"string"==typeof t&&(s=JSON.parse(t)),e(Ge(s))}})(s,n,t)}}function Re(){return{type:ye}}function Ue(){return{type:Ee}}function Ge(e){return{type:ke,errorData:e}}function Be(e,t){return{type:we,field:e,value:t}}function He(e,t){return{type:Ce,field:e,error:t}}function We(e){return{type:ve,field:e}}function Ve(e){return{type:xe,data:e}}function $e(){return{type:Te}}function Ke(){return{type:Ie}}var Ye=s(7821),qe=s.n(Ye);let ze,Je,Xe;!function(e){e.af="af",e.am="am",e.ar="ar",e.arEG="ar-EG",e.arMA="ar-MA",e.arSA="ar-SA",e.az="az",e.bg="bg",e.bn="bn",e.bho="bho",e.bs="bs",e.ca="ca",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.enGB="en-GB",e.es419="es-419",e.es="es",e.esAR="es-AR",e.esMX="es-MX",e.et="et",e.eu="eu",e.fa="fa",e.fi="fi",e.fil="fil",e.frCA="fr-CA",e.fr="fr",e.gl="gl",e.gu="gu",e.he="he",e.hi="hi",e.hr="hr",e.hu="hu",e.id="id",e.is="is",e.it="it",e.ja="ja",e.kn="kn",e.ko="ko",e.lt="lt",e.lv="lv",e.mk="mk",e.ml="ml",e.mr="mr",e.ms="ms",e.nb="nb",e.ne="ne",e.nl="nl",e.or="or",e.paIN="pa-IN",e.paPK="pa-PK",e.pl="pl",e.ptBR="pt-BR",e.ptPT="pt-PT",e.ro="ro",e.ru="ru",e.sk="sk",e.sl="sl",e.sr="sr",e.sv="sv",e.sw="sw",e.ta="ta",e.te="te",e.th="th",e.tr="tr",e.uk="uk",e.ur="ur",e.vi="vi",e.zhCN="zh-CN",e.zhHK="zh-HK",e.zhTW="zh-TW",e.zu="zu"}(ze||(ze={})),function(e){e.AR="، ",e.FA="، ",e.EN=", "}(Je||(Je={})),function(e){e.ZERO="zero",e.ONE="one",e.TWO="two",e.FEW="few",e.MANY="many",e.OTHER="other"}(Xe||(Xe={}));let Ze={};function Qe(e){return"number"==typeof e?e.toString():e.replace(/\$/,"$$$$")}const et=e=>"ar"===e?"ar-u-nu-latn":e;const tt=new class{_relativeTimeFormat=null;_dateTimeFormats=new Map;constructor(){this._dictionary={},this._locale=ze.en}getDateTimeFormat(e){const t=JSON.stringify(Object.keys(e).sort().map((t=>({[t]:e[t]}))));let s=this._dateTimeFormats.get(t);return void 0===s&&(s=new Intl.DateTimeFormat(et(this._locale),e),this._dateTimeFormats.set(t,s)),s}getRelativeTimeFormat(){return null===this._relativeTimeFormat&&(this._relativeTimeFormat=void 0===Intl.RelativeTimeFormat?null:new Intl.RelativeTimeFormat(this._locale)),this._relativeTimeFormat}getDictionary(){return this._dictionary}setDictionary(e){this._dictionary=e}setLocale(e){this._locale=e,this._dateTimeFormats.clear(),this._relativeTimeFormat=null}getLocale(){return this._locale}getSmartlingLocale(){const e=this._locale;return qe()[e]||e}toLocaleLowerCase(e){return e?.toLocaleLowerCase(this._locale)}toLocaleUpperCase(e){return e?.toLocaleUpperCase(this._locale)}get(e,...t){const s=e in this._dictionary?this._dictionary[e]:e;let n="";if("string"!=typeof s){const e=t[0],r=((e,t)=>{try{return(Ze[e]||(Ze[e]=new Intl.PluralRules(e))).select(t)}catch{return Xe.OTHER}})(this._locale,parseInt(e,10)),o=s[r];void 0!==o?n=o:s.other&&(n=s.other)}else n=s;if(/%\d%/.test(n)){if(!["desktop.login.DefaultErrorMessage","desktop.login.ErrorProxyAuthRequired","desktop.login.MissingUserInfoMessage","desktop.login.RegionMismatchMessage","desktop.login.ClientUpdateFail","desktop.login.FbUserNotFoundSignUp","desktop-auth.error"].includes(e))throw new Error("i18n: The placeholder format %0% is legacy and is only allowed for existing strings.")}if(t?.length>0)for(let e=0;e<t.length;e++){const s=t[e];if(null!=s)if("string"==typeof s)n=n.replace(`{${e}}`,Qe(s)).replace(`%${e}%`,Qe(s));else if("number"==typeof s){const t=this.formatNumber(s);n=n.replace(`{${e}}`,t).replace(`%${e}%`,t)}else if("object"==typeof s)for(const e of Object.keys(s)){const t=s[e];n=n.replace(`%${e}%`,Qe(t))}}return n}getSeparator(){switch(this._locale){case ze.ar:return Je.AR;case ze.fa:return Je.FA;default:return Je.EN}}formatNumber(e,t){return e.toLocaleString(et(this._locale),t)}formatNumberCompact(e){return this.formatNumber(e,{notation:"compact",maximumFractionDigits:1})}formatDate(e,t=null){const s=t||{year:"numeric",month:"long",day:"numeric"};return this.getDateTimeFormat(s).format(e)}formatRelativeDate(e,t=null){const s=new Date(Date.now());e=new Date(e);const n=this.getRelativeTimeFormat(),r=e.getTime()-s.getTime(),o=Math.abs(r)<2592e6;if(null!==n&&o){const{weeks:e,days:t,hours:s,minutes:o,seconds:a}=(i=r,{seconds:Math.round(i/1e3),minutes:Math.round(i/1e3/60),hours:Math.round(i/1e3/60/60),days:Math.round(i/1e3/60/60/24),weeks:Math.round(i/1e3/60/60/24/7)});return Math.abs(t)>=7?n.format(e,"weeks"):Math.abs(s)>=24?n.format(t,"days"):Math.abs(o)>=60?n.format(s,"hours"):Math.abs(a)>=60?n.format(o,"minutes"):n.format(a,"seconds")}var i;return this.formatDate(e,t)}__resetForTests(){this._dictionary={},this._locale=ze.en,Ze={}}},st=2,nt=3,rt=4,ot={"auto-detect":{label:()=>tt.get("desktop.settings.proxy.autodetect")},"no-proxy":{label:()=>tt.get("desktop.settings.proxy.noproxy")},http:{label:()=>tt.get("desktop.settings.proxy.http")},socks4:{label:()=>tt.get("desktop.settings.proxy.socks4")},socks5:{label:()=>tt.get("desktop.settings.proxy.socks5")}},it=[{enumKey:"auto-detect",enumValue:0},{enumKey:"no-proxy",enumValue:1},{enumKey:"http",enumValue:2},{enumKey:"socks4",enumValue:3},{enumKey:"socks5",enumValue:4}],at="sp://proxy/v1/";const lt="SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS",dt="SETTINGS_FETCH_PROXY_SETTINGS_FAILURE",ct="SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS",ut="SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE",pt="SETTINGS_RESTART_CLIENT_SUCCESS",ht="SETTINGS_RESTART_CLIENT_FAILURE";function gt(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"GET",uri:at}),persistent:!1,onSuccess:s=>{const n=JSON.parse(s);200!==n.status&&t(new Error(`Failed to fetch proxy settings (status code: ${n.status})`));const r=JSON.parse(n.body);e({mode:r["network.proxy.mode"],address:r["network.proxy.addr"],username:r["network.proxy.user"],password:r["network.proxy.pass"]})},onFailure:(e,s)=>{t(e)}})}))})().then((t=>{e(function(e){return{type:lt,data:e}}(t))}),(t=>{e(function(e){return{type:dt,error:e}}(t))}))}}function mt(e){return t=>{(async function(e){return new Promise(((t,s)=>{const n={"network.proxy.mode":e.mode};[st,nt,rt].includes(e.mode)&&(n["network.proxy.addr"]=e.address,n["network.proxy.user"]=e.username),[st,rt].includes(e.mode)&&(n["network.proxy.pass"]=e.password),window.sendCosmosRequest({request:JSON.stringify({method:"PUT",uri:at,body:JSON.stringify(n)}),persistent:!1,onSuccess:()=>{t()},onFailure:(e,t)=>{s(e)}})}))})(e).then((()=>{t({type:ct}),t(gt())}),(e=>{t(function(e){return{type:ut,error:e}}(e))}))}}function _t(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"POST",uri:"sp://desktop/v1/restart"}),persistent:!1,onSuccess:()=>{e()},onFailure:(e,s)=>{t(e)}})}))})().then((()=>{e({type:pt})}),(t=>{e(function(e){return{type:ht,error:e}}(t))}))}}const ft={...r,...n,...o,...i};var bt=s(9496),St=s(4637);class yt extends bt.Component{constructor(e){super(e),this.state={hidden:this.props.delay>0}}componentDidMount(){!0===this.state.hidden&&(this.throbberTimeout=setTimeout((()=>{this.setState({hidden:!1})}),this.props.delay))}componentWillUnmount(){this.throbberTimeout&&clearTimeout(this.throbberTimeout)}render(){return this.state.hidden?null:(0,St.jsx)("div",{"data-testid":"glue-throbber",className:"GlueThrobber "+(this.props.initial?"throbber-initial":"throbber"),children:(0,St.jsx)("div",{})})}}yt.defaultProps={delay:0,initial:!0};var Et=s(5530),kt=s.n(Et);function wt(){return kt().create().toString()}var Ct=s(1094),vt=s(3163);class xt extends bt.PureComponent{constructor(e){super(e),this.handleLoginClick=this.handleLoginClick.bind(this),this.handleErrorClick=this.handleErrorClick.bind(this)}handleLoginClick(){const e=wt();this.props.openLoginPage(e),this.props.onInteraction("login/welcome","click","open-page-login",null,e)}handleErrorClick(e){if(e.target.getAttribute("data-action")){"showSettings"===e.target.getAttribute("data-action")&&this.props.openSettingsPage()}}render(){const{errorMessage:e}=this.props;return(0,St.jsxs)("main",{className:"Welcome","data-testid":"welcome",children:[(0,St.jsxs)("h1",{className:"HeroText __welcome",children:[tt.get("desktop-auth.login.millions-of-songs"),(0,St.jsx)("br",{}),tt.get("desktop-auth.login.free-on-spotify")]}),(0,St.jsxs)("div",{className:"Welcome__signup-or-login",children:[e&&(0,St.jsxs)("div",{className:"Welcome__error-message",role:"alert",onClick:this.handleErrorClick,"aria-live":"assertive",children:[(0,St.jsx)(Ct.l,{className:"Welcome__error-message__icon"}),(0,St.jsx)("span",{dangerouslySetInnerHTML:{__html:e}})]}),(0,St.jsx)(vt.D,{id:"login-button",onClick:this.handleLoginClick,"data-ta-id":"welcome-login-button","data-testid":"login-button",fullWidth:!0,children:tt.get("desktop.login.LoginButton")})]})]})}}const Tt=(0,d.$j)((e=>({errorMessage:e.app.errorMessage})),(e=>({openLoginPage:t=>e(ft.enterLoginMode(t)),openSettingsPage:()=>e(ft.enterSettingsMode()),onInteraction:(t,s,n,r,o)=>e(ft.interaction(t,s,n,r,o))})))(xt);var It=s(8045),Nt=s(372);const At="https://www.spotify.com/redirect/account-page/",Pt="showSettings",Dt={id:"UnknownLoginErrorMessage"},Ft={id:"DefaultErrorMessage",replace:[Pt]},Mt={127:{id:"SessionTerminatedMessage"},3:{id:"BadCredentialsMessage"},4:{id:"ErrorResolvingDNS"},53:{id:"ErrorProxyUnauthorized"},54:{id:"ErrorProxyForbidden"},55:{id:"ErrorProxyAuthRequired",replace:[Pt]},400:Dt,401:Dt,402:{id:"CriticalUpdate"},403:{id:"UserBannedMessage"},404:Dt,405:Dt,406:{id:"UserNotAllowedOnPlatformMessage"},407:{id:"MissingUserInfoMessage",replace:[At]},408:{id:"RegionMismatchMessage",replace:[At,"https://www.spotify.com/redirect/upgrade-product/"]},409:{id:"PremiumUsersOnlyMessage"},410:{id:"BadCredentialsMessage"},411:Dt,412:{id:"BadCredentialsMessage"},413:{id:"CreateUserDeniedMessage"},414:Dt,415:Dt,416:Dt,417:{id:"FacebookCredentialsMisusedMessage"},418:Dt,"critical-update-error":{id:"ClientUpdateFail",replace:["https://www.spotify.com/redirect/download/"]}},Ot={1:Dt,2:Dt,3:{id:"BadCredentialsMessage"},4:Dt,5:Dt,6:Dt,7:Dt,8:Dt,9:Dt},Lt={1:{silent:!0},2:Dt,3:Dt,4:{id:"SessionExpiredMessage"},5:Ft};function jt(e,t,s){if(0===t)return!1;if(!e&&!t)return!1;let n=Mt;switch(e){case"session":n=Ot;break;case"desktop_login_accounts":n=Lt}const r=n[t]||Ft;if(r.silent)return!1;const o=r.replace||[];let i="";switch(r.id){case"UnknownLoginErrorMessage":i=tt.get("desktop.login.UnknownLoginErrorMessage");break;case"DefaultErrorMessage":i=tt.get("desktop.login.DefaultErrorMessage",o[0]);break;case"SessionTerminatedMessage":i=tt.get("desktop.login.SessionTerminatedMessage");break;case"SessionExpiredMessage":i=tt.get("desktop.login.SessionExpiredMessage");break;case"BadCredentialsMessage":i=tt.get("desktop.login.BadCredentialsMessage");break;case"ErrorResolvingDNS":i=tt.get("desktop.login.ErrorResolvingDNS");break;case"ErrorProxyUnauthorized":i=tt.get("desktop.login.ErrorProxyUnauthorized");break;case"ErrorProxyForbidden":i=tt.get("desktop.login.ErrorProxyForbidden");break;case"ErrorProxyAuthRequired":i=tt.get("desktop.login.ErrorProxyAuthRequired",o[0]);break;case"CriticalUpdate":i=tt.get("desktop.login.CriticalUpdate");break;case"UserBannedMessage":i=tt.get("desktop.login.UserBannedMessage");break;case"UserNotAllowedOnPlatformMessage":i=tt.get("desktop.login.UserNotAllowedOnPlatformMessage");break;case"MissingUserInfoMessage":i=tt.get("desktop.login.MissingUserInfoMessage",o[0]);break;case"RegionMismatchMessage":i=tt.get("desktop.login.RegionMismatchMessage",o[0],o[1]);break;case"PremiumUsersOnlyMessage":i=tt.get("desktop.login.PremiumUsersOnlyMessage");break;case"CreateUserDeniedMessage":i=tt.get("desktop.login.CreateUserDeniedMessage");break;case"ClientUpdateFail":i=tt.get("desktop.login.ClientUpdateFail",o[0]);break;case"FbUserNotFoundSignUp":i=tt.get("desktop.login.FbUserNotFoundSignUp",o[0])}return s?`${i}<br>${tt.get("desktop.login.errorCode",s)}`:i}function Rt({validity:e={}}){return e.valid?null:["valueMissing","typeMismatch","tooShort"].find((t=>e[t]))}const Ut="H5vfurs7KNEs9Io5DUA7",Gt="qfBRU_bttJde7gy46oAB",Bt="ypTrzM1PtlrZp04qs6Eq",Ht="oHZmDpK0SrWDaXhPjUtC",Wt="lAHowB9HYfAUrg9UaSde";var Vt=s(9557);const $t=kt().create().toString(),Kt="has-used-app",Yt=!window.localStorage.getItem(Kt);Yt&&window.localStorage.setItem(Kt,!0);const qt=()=>{const e=h.getItem("utmParameters");let t;try{t=e?JSON.parse(e).referral:""}catch(e){t=""}return t};class zt{constructor(e){this._eventSender=e}logPageView({page:e}){this.logAction({page:e,action_type:"pageview",action_intent:""})}logAction({page:e,action_type:t,action_intent:s,item_id:n,action_hash:r},o){this._eventSender.send((0,Vt.e)({action_type:t,action_intent:s,action_page:e,action_item_id:n,action_hash:r,device_is_new_install:Yt,device_locale:window.__spotify.locale,device_referrer:qt(),ab_flags:"",session_id:$t}),o)}}var Jt;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.OPERATION_ABORTED=1]="OPERATION_ABORTED",e[e.OPERATION_TIMED_OUT=2]="OPERATION_TIMED_OUT",e[e.LOGIN_BAD_CREDENTIALS=3]="LOGIN_BAD_CREDENTIALS",e[e.LOGIN_BAD_APP_KEY=4]="LOGIN_BAD_APP_KEY",e[e.LOGIN_BAD_CLIENT_VERSION_INFO=5]="LOGIN_BAD_CLIENT_VERSION_INFO",e[e.STORAGE_INITIALIZATION_FAILED=6]="STORAGE_INITIALIZATION_FAILED",e[e.MULTIPLE_LOGIN_NOT_ALLOWED=7]="MULTIPLE_LOGIN_NOT_ALLOWED",e[e.OPERATION_CANCELLED=8]="OPERATION_CANCELLED",e[e.BAD_DEVICE_INFO=9]="BAD_DEVICE_INFO",e[e.INTERNAL_ERROR=10]="INTERNAL_ERROR"}(Jt||(Jt={}));const Xt=function({eventSender:e}){const[t,s]=(0,bt.useState)(""),[n,r]=(0,bt.useState)(!1),[o,i]=(0,bt.useState)(!1),a=function(){const e=(0,d.I0)();return()=>{e(ne())}}(),l=(0,bt.useRef)(0),c=(0,bt.useMemo)((()=>new zt(e)),[e]);(0,bt.useEffect)((()=>{c.logPageView({page:"auth-on-web"})}),[c]);const u=async t=>{const n=++l.current,o=wt();i(t),s(""),r(!0),c.logAction({page:"auth-on-web",action_type:"click",action_intent:t?"sign-up-with-browser":"log-in-with-browser",action_hash:o});try{await p({name:N,args:[{method:"login-accounts",enableSignup:t,actionHash:o}]}),c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"show-success-signup":"show-success-login"},{flush:!1}),await e.finalFlush(),location.href="spotify:app:xpui"}catch(e){const o="string"==typeof e?JSON.parse(e):e;if(n!==l.current)return void c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"sign-up-with-browser-cancelled-by-new-attempt":"log-in-with-browser-cancelled-by-new-attempt",item_id:o?.errorReference});r(!1);let i=jt(o.errorCategory,o.errorCode,o.errorReference);"desktop_login_accounts"===o.errorCategory&&o.errorCode===Jt.OPERATION_TIMED_OUT&&(i=t?tt.get("desktop-auth.login.signup-time-out"):tt.get("desktop-auth.login.login-time-out")),s(i||""),c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"show-error-signup":"show-error-login",item_id:o?.errorReference})}};return(0,St.jsx)("main",{children:n?(0,St.jsxs)(St.Fragment,{children:[(0,St.jsx)(It.D,{as:"h1",variant:"alto",semanticColor:"textBase",className:Ut,children:o?tt.get("desktop-auth.login.go-to-browser-signup"):tt.get("desktop-auth.login.go-to-browser-login")}),(0,St.jsxs)("button",{className:Bt,onClick:()=>{r(!1),c.logAction({page:"auth-on-web",action_type:"click",action_intent:"try-again"})},children:[(0,St.jsx)(It.D,{as:"span",variant:"ballad",semanticColor:"textSubdued",children:tt.get("desktop-auth.login.not-seeing-browser")})," ",(0,St.jsx)(It.D,{as:"span",variant:"balladBold",semanticColor:"textBase",children:tt.get("desktop-auth.login.try-again")})]})]}):(0,St.jsxs)(St.Fragment,{children:[(0,St.jsxs)(It.D,{as:"h1",variant:"alto",semanticColor:"textBase",className:Ut,children:[tt.get("desktop-auth.login.millions-of-songs"),(0,St.jsx)("br",{}),tt.get("desktop-auth.login.free-on-spotify")]}),t&&(0,St.jsxs)("div",{className:Ht,role:"alert",onClick:e=>{if(e.currentTarget.getAttribute("data-action")){"showSettings"===e.currentTarget.getAttribute("data-action")&&a()}},"aria-live":"assertive",children:[(0,St.jsx)(Ct.l,{className:Wt}),(0,St.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]}),(0,St.jsx)(vt.D,{onClick:()=>{u(!1)},iconTrailing:Nt.T,children:tt.get("desktop-auth.login.log-in-with-browser")}),(0,St.jsxs)("button",{className:Gt,onClick:()=>{u(!0)},children:[(0,St.jsx)(It.D,{as:"span",variant:"ballad",semanticColor:"textSubdued",children:tt.get("desktop-auth.login.new-to-spotify")}),(0,St.jsx)(It.D,{as:"span",variant:"balladBold",semanticColor:"textBase",children:tt.get("desktop-auth.login.sign-up-with-browser")}),(0,St.jsx)(Nt.T,{iconSize:16,semanticColor:"textBase"})]})]})})};var Zt=s(6893),Qt=s(4419),es=s(6627),ts=s(4875),ss=s.n(ts);const ns=()=>(0,St.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,St.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8ZM7.25 3V10H8.75V3H7.25ZM7.25 11.5256V13.0256H8.75V11.5256H7.25Z",fill:"#eb6471"})});class rs extends bt.PureComponent{render(){const{errorMessage:e}=this.props;return(0,St.jsxs)("div",{"aria-live":"polite",className:ss()("FieldError",{"FieldError--hidden":!e}),children:[(0,St.jsx)(ns,{}),(0,St.jsx)("span",{children:e||""})]})}}let os=0;class is extends bt.PureComponent{constructor(...e){super(...e),this.idNumber=++os,this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onChange(e)}render(){const{label:e,placeholderLabel:t,name:s,type:n,isRequired:r,taId:o,id:i,defaultValue:a,value:l,minLength:d,autoFocus:c,hasError:u,isDisabled:p,isHiddenForScreenReaders:h,useCustomStyle:g,className:m,inputClassName:_,inputRef:f,onBlur:b,onFocus:S,onInput:y,onKeyDown:E,onKeyUp:k}=this.props,w=i||`GlueTextInput-${this.idNumber}`;return(0,St.jsx)("label",{className:g?m:"GlueTextInput",htmlFor:w,"aria-label":e,"aria-hidden":!!h||void 0,children:(0,St.jsx)("input",{className:g?_:ss()("GlueTextInput__input",{"GlueTextInput__input--has-error":u}),tabIndex:h?"-1":void 0,type:n,id:w,name:s,"data-ta-id":o,"aria-invalid":u,disabled:p,minLength:d,autoFocus:c,placeholder:t||e,value:a?void 0:l,defaultValue:a,onBlur:b,onFocus:S,onChange:this.handleChange,onInput:a?void 0:y,onKeyDown:E,onKeyUp:k,ref:f,required:r})})}}is.defaultProps={name:"",type:"text",isRequired:!1,taId:"",defaultValue:void 0,value:"",minLength:0,autoFocus:!1,hasError:!1,isDisabled:!1,isHiddenForScreenReaders:!1,useCustomStyle:!1,onBlur(){},onFocus(){},onChange(){},onInput(){},onKeyDown(){}};class as extends bt.PureComponent{constructor(e){super(e),this.state={isEditing:!1,passwordVisible:!1},this.handleBlur=this.handleBlur.bind(this),this.handleInput=this.handleInput.bind(this)}handleBlur({target:e,relatedTarget:t}){this.setState({isEditing:!1}),t&&(t.name||"submit"===t.type)&&this.validate(e)}handleInput(){this.setState({isEditing:!0})}handleTogglePasswordVisible=()=>{const e=!this.state.passwordVisible;this.setState({passwordVisible:e}),this.props.onTogglePasswordVisibility&&this.props.onTogglePasswordVisibility(e)};validate(e){const{name:t,onValidate:s,noValidate:n}=this.props;!n&&s&&s(t,Rt(e))}renderPasswordEyeToggler(){const{type:e}=this.props,{passwordVisible:t}=this.state;return"password"!==e?null:(0,St.jsxs)(bt.Fragment,{children:[(0,St.jsx)("button",{type:"button",onClick:this.handleTogglePasswordVisible,tabIndex:"-1",className:"FormField--passwordEyeIcon "+(t?"passwordVisible":"")}),(0,St.jsx)("span",{tabIndex:"-1",className:"FormField--passwordEyeIcon--cross "+(t?"passwordVisible":"")})]})}render(){const{error:e={},noValidate:t,label:s,name:n,type:r,value:o,isRequired:i,minLength:a,autoFocus:l,isDisabled:d,onChange:c,onKeyUp:u,onFocus:p,rightIcon:h=null}=this.props,{isEditing:g,passwordVisible:m}=this.state,_=h;let f=r;return"password"===r&&m&&(f="text"),(0,St.jsxs)("div",{className:ss()("FormField",{"FormField--no-validate":t}),children:[(0,St.jsx)(is,{label:s,name:n,type:f,taId:`${n}-field`,value:o,isRequired:i,minLength:a,autoFocus:l,hasError:!!e.message&&!g,isDisabled:d,onChange:c,onFocus:p,onKeyUp:u,onBlur:this.handleBlur,onInput:this.handleInput}),_&&(0,St.jsx)(_,{className:"FormField--rightIcon"}),this.renderPasswordEyeToggler(),!t&&!g&&e.message&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rs,{errorMessage:e.message})})]})}}const ls=(0,d.$j)((()=>({})),(()=>({})))(as);class ds extends bt.PureComponent{constructor(...e){super(...e),this.handleBlur=this.handleBlur.bind(this)}handleBlur(e={}){this.props.onBlur&&this.props.onBlur(e)}render(){const{type:e="text",name:t,label:s,classes:n,hasError:r,...o}=this.props,i=`${t}-field`;return(0,St.jsxs)("span",{className:n,children:[(0,St.jsx)("label",{className:"glue-hidden-visually",htmlFor:i,children:s}),(0,St.jsx)("input",{...o,onBlur:this.handleBlur,type:e,name:t,id:i,"data-ta-id":i,className:ss()("form-control Input",{"Input--has-error":r}),"aria-invalid":!!r,placeholder:s,required:!0})]})}}const cs=(new Date).getFullYear()-120,us=(e,t,s)=>{let n=null;return((e,t,s)=>[e,t,s].reduce(((e,t)=>e&&!!t),!0))(e,t,s)?((e,t,s)=>{const n=new Date(s,t-1,e);return!(n.getFullYear()<cs)&&n.getDate()===e&&n.getMonth()===t-1&&n.getFullYear()===s})(e,t,s)||(n="invalid"):n="incomplete",n},ps={BIG_ENDIAN:"big",LITTLE_ENDIAN:"little",MIDDLE_ENDIAN:"middle"};class hs extends bt.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.monthStrings=[tt.get("desktop.login.January"),tt.get("desktop.login.February"),tt.get("desktop.login.March"),tt.get("desktop.login.April"),tt.get("desktop.login.May"),tt.get("desktop.login.June"),tt.get("desktop.login.July"),tt.get("desktop.login.August"),tt.get("desktop.login.September"),tt.get("desktop.login.October"),tt.get("desktop.login.November"),tt.get("desktop.login.December")],this.handleInput=this.handleInput.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleInput({target:{name:e,value:t,validity:s={}}}){this.setState({isEditing:!0});const n=parseInt(t,10);s.valueMissing||!isFinite(t)||isNaN(n)?this.props.onChange({...this.props.value,[e]:void 0}):this.props.onChange({...this.props.value,[e]:n})}handleBlur(e){const t=e.relatedTarget?e.relatedTarget.name:null,s=["day","month","year"].includes(t);this.setState({isEditing:s}),s||this.validate()}handleFocus(e){this.setState({isEditing:!0});const t=e.relatedTarget?e.relatedTarget.name:null;!["day","month","year"].includes(t)&&this.props.onFocus&&this.props.onFocus()}validate(){const{day:e,month:t,year:s}=this.props.value,n=us(e,t,s,this.props.minAge);this.props.onValidate("birthDate",n)}renderYear(e,t,s){return(0,St.jsx)(ds,{type:"number",name:"year",classes:"FormDate__input FormDate__year",label:tt.get("desktop.login.Year"),autoFocus:s,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:cs,hasError:t.includes("year"),onFocus:this.handleFocus})}renderMonth(e,t,s){return(0,St.jsxs)("select",{name:"month",id:"month-field",className:ss()("form-control Input FormDate__input FormDate__month",{"Input--has-error":t.includes("month")}),autoFocus:s,defaultValue:e||"",required:!0,onChange:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,onFocus:this.handleFocus,children:[(0,St.jsx)("option",{value:"",disabled:!0,hidden:!0,children:tt.get("desktop.login.Month")}),this.monthStrings.map(((e,t)=>(0,St.jsx)("option",{value:t+1,children:e},t)))]})}renderDay(e,t,s){return(0,St.jsx)(ds,{type:"number",name:"day",classes:"FormDate__input FormDate__day",label:tt.get("desktop.login.Day"),autoFocus:s,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:1,max:31,hasError:t.includes("day"),onFocus:this.handleFocus})}render(){const{name:e,label:t,dateEndianness:s,error:n={},autoFocus:r}=this.props,{day:o,month:i,year:a}=this.props.value,{isEditing:l}=this.state,d=["day","month","year"].filter((e=>!(l||!n.message)&&("incomplete"===n.code?!this.props.value[e]:"tooOld"!==n.code||"year"===e)));let c="";return c="big"===ps[s]?(0,St.jsxs)("div",{className:"FormDate__inputs",children:[this.renderYear(a,d,r),this.renderMonth(i,d),this.renderDay(o,d)]}):"little"===ps[s]?(0,St.jsxs)("div",{className:"FormDate__inputs",children:[this.renderDay(o,d,r),this.renderMonth(i,d),this.renderYear(a,d)]}):(0,St.jsxs)("div",{className:"FormDate__inputs",children:[this.renderMonth(i,d,r),this.renderDay(o,d),this.renderYear(a,d)]}),(0,St.jsxs)("div",{className:"FormDate",children:[(0,St.jsx)("label",{className:`FormDate__label ${e}-label`,htmlFor:"month-field",children:t}),c,!l&&n.message&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rs,{errorMessage:n.message})})]})}}hs.defaultProps={value:{},dateEndianness:"MIDDLE_ENDIAN",minAge:13};const gs=(0,d.$j)((()=>({})),(()=>({})))(hs);class ms extends bt.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleBlur(e){this.state={isEditing:!1};(e.relatedTarget?e.relatedTarget.name:null)!==this.props.name&&this.validate(e.target)}handleFocus(e){this.state={isEditing:!0},this.props.onOptionFocus&&e&&e.target&&this.props.onOptionFocus(e.target.value)}validate(e){const{name:t,onValidate:s}=this.props;s&&s(t,Rt(e))}render(){const{name:e,label:t,options:s,value:n,showTitle:r,error:o={},onValidate:i,onOptionFocus:a,...l}=this.props,{isEditing:d}=this.state,c=`${e}-field`,u=ss()("FormRadioSelect",{"FormRadioSelect--is-disabled":this.props.disabled});return(0,St.jsxs)("div",{className:u,children:[(0,St.jsx)("label",{className:r?"":"glue-hidden-visually",htmlFor:c,children:t}),s.map((t=>{const s=`${t.value}-radio`;return(0,St.jsxs)("span",{className:n===t.value?"checked":"",children:[(0,St.jsx)("input",{...l,name:e,type:"radio",id:s,className:"glue-hidden-visually",value:t.value,checked:n===t.value,onBlur:this.handleBlur,onFocus:this.handleFocus,required:!0,disabled:this.props.disabled}),(0,St.jsx)("label",{className:ss()("FormRadioSelect__label",{"FormRadioSelect__label--has-error":!!o.message}),htmlFor:s,children:t.label})]},t.value)})),!d&&o.message&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rs,{errorMessage:o.message})})]})}}const _s=(0,d.$j)((()=>({})),(()=>({})))(ms);class fs extends bt.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.isDisabled||this.props.onChange(e.target.checked)}render(){const e=`${this.props.name}-field`,t=ss()("GlueCheckbox",{"GlueCheckbox--is-disabled":this.props.isDisabled});return(0,St.jsxs)("div",{className:t,children:[(0,St.jsx)("input",{className:"GlueCheckbox__input",id:e,name:this.props.name,checked:this.props.isChecked,type:"checkbox",onChange:this.handleChange,disabled:this.props.isDisabled}),(0,St.jsx)("label",{className:"GlueCheckbox__label",htmlFor:e,dangerouslySetInnerHTML:{__html:this.props.label}})]})}}fs.defaultProps={label:"",name:"",isChecked:!1,isDisabled:!1,onChange(){}};class bs extends bt.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(e){if(e.target.getAttribute("data-action")){"showSettings"===e.target.getAttribute("data-action")&&this.props.openSettingsPage()}}render(){const e=this.props.errorData,t=e?jt(e.errorCategory,e.errorCode,e.errorReference):null;return t?(0,St.jsxs)("div",{className:"alert alert-danger ErrorMessage alert-icon",id:"login-message","data-ta-id":"login-message","data-testid":"login-message",role:"alert","aria-live":"assertive",onClick:this.handleClick,children:[(0,St.jsx)(Ct.l,{iconSize:24}),(0,St.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]}):null}}const Ss=(0,d.$j)((e=>{let{mode:t}=e.app;return"welcome"===t&&(t="signup"),{errorData:e[t]&&e[t].errorData?e[t].errorData:null}}),(e=>({openSettingsPage:()=>e(ft.enterSettingsMode()),openSignupPage:()=>e(ft.openSignupPage())})))(bs);class ys extends bt.PureComponent{static getNextId(){const e=(ys.instanceCount||0)+1;return ys.instanceCount=e,e}constructor(e){super(e),this.state={tosAgreed:!1,privacyAgreed:!1},this.handleTosChange=this.handleTosChange.bind(this),this.handlePrivacyChange=this.handlePrivacyChange.bind(this),this.handleTosAndPrivacyChange=this.handleTosAndPrivacyChange.bind(this),this.handleEulaChange=this.handleEulaChange.bind(this),this.eulaId=ys.getNextId()}handleTosChange(e){this.setState({tosAgreed:e},(()=>{this.handleEulaChange()}))}handlePrivacyChange(e){this.setState({privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleTosAndPrivacyChange(e){this.setState({tosAgreed:e,privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleEulaChange(){this.props.onChange(this.state.tosAgreed&&this.state.privacyAgreed)}render(){let e=null;const t=`<a href="https://www.spotify.com/int/legal/end-user-agreement/" target="_new">${tt.get("desktop.login.TermsAndConditions")}</a>`,s=`<a href="https://www.spotify.com/int/legal/privacy-policy/" target="_new">${tt.get("desktop.login.PrivacyPolicy")}</a>`,n=tt.get("desktop.login.SignupButton");return e=this.props.restrictions.pretick_eula?(0,St.jsxs)("div",{children:[!this.props.hideTermsAndConditions&&(0,St.jsx)("p",{className:"SignupForm__terms-and-conditions",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.SignupAgree",n,t)}}),!this.props.hidePrivacyPolicy&&(0,St.jsx)("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.PrivacyPolicyAgree",s)}})]}):this.props.restrictions.can_accept_licenses_in_one_step?(0,St.jsxs)("div",{className:"SignupForm__checkbox-container",children:[(0,St.jsx)(fs,{"data-ta-id":"agree-eula",name:`agree-eula-${this.eulaId}`,label:this.props.restrictions.specific_licenses?tt.get("desktop.login.SignupAgreeCheckboxSpecificLicenses",t,s):tt.get("desktop.login.SignupAgreeCheckbox",t,s),onChange:this.handleTosAndPrivacyChange,isChecked:this.state.tosAgreed&&this.state.privacyAgreed,isDisabled:this.props.disabled}),this.props.restrictions.specific_licenses&&(0,St.jsx)("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.PrivacyPolicyAgree",s)}})]}):(0,St.jsxs)("div",{children:[(0,St.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,St.jsx)(fs,{"data-ta-id":"agree-tos",name:`agree-tos-${this.eulaId}`,label:tt.get("desktop.login.TermsOfServiceAgreeCheckbox",t),onChange:this.handleTosChange,isChecked:this.state.tosAgreed,isDisabled:this.props.disabled})}),(0,St.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,St.jsx)(fs,{"data-ta-id":"agree-privacy",name:`agree-privacy-${this.eulaId}`,label:tt.get("desktop.login.PrivacyPolicyAgreeCheckbox",s),onChange:this.handlePrivacyChange,isChecked:this.state.privacyAgreed,isDisabled:this.props.disabled})})]}),(0,St.jsxs)("div",{className:"EulaAgreement",children:[e,this.props.error&&(0,St.jsx)(St.Fragment,{children:(0,St.jsx)(rs,{errorMessage:this.props.error.message})})]})}}const Es=(0,d.$j)((()=>({})),(()=>({})))(ys);class ks extends bt.PureComponent{handleClick=e=>{const{method:t}=this.props;e&&(e.preventDefault(),e.stopPropagation()),this.props.onClick(t)};render(){const{type:e,label:t,isDisabled:s,method:n}=this.props,r=n.substr(0,1).toUpperCase()+n.substr(1),o=ss()("button","SocialButton",`${r}Button`,{[`${r}Button--login`]:"login"===e,[`${r}Button--signup`]:"signup"===e});return(0,St.jsx)("button",{type:"button",className:o,onClick:this.handleClick,"data-ta-id":`${n}-${e}-button`,disabled:s,children:t})}}class ws extends bt.PureComponent{static defaultProps={isDisabled:!1,hideEula:!1};constructor(e){super(e),this.state={eulaAgreed:this.props.restrictions.pretick_eula,error:{}}}handleAgreeEulaChange=e=>{const t=e?"checked":"unchecked";this.props.onInteraction("signup","click",`eula-change-${t}`,null,this.props.actionHash),this.setState({eulaAgreed:e,error:e?{}:this.state.error})};handleOnClick=(...e)=>{(()=>this.state.eulaAgreed||this.props.restrictions.pretick_eula||this.props.hideEula)()?this.props.onClick(...e):this.setState({error:{message:tt.get("desktop.login.agreeEula.notAccepted")}})};render(){return(0,St.jsxs)("div",{className:"SignupFacebook",children:[(0,St.jsx)(ks,{method:"facebook",isDisabled:this.props.isDisabled,onClick:e=>this.handleOnClick(e,this.props.actionHash),type:"signup",label:tt.get("desktop.login.SignupButtonFacebookNirvana")}),this.props.restrictions.pretick_eula||this.props.hideEula?null:(0,St.jsx)(Es,{restrictions:this.props.restrictions,error:this.state.error,disabled:this.props.isDisabled,onChange:this.handleAgreeEulaChange})]})}}const Cs=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions,actionHash:e.app.currentActionHash??wt()})),(e=>({onInteraction:(t,s,n,r,o)=>e(ft.interaction(t,s,n,r,o)),onClick:(t,s)=>{e(ft.signupWithAccounts(t,s)),e(ft.interaction("signup","click",`create-account-${t}`,null,s))}})),((e,t)=>({...e,...t,onClick:(e,s)=>{t.onClick(e,s)}})))(ws),vs=({title:e})=>(0,St.jsx)("p",{className:"FormTitleSeparator","aria-hidden":"true",children:e});vs.defaultProps={title:""};const xs=vs;class Ts extends bt.PureComponent{static defaultProps={errors:{},data:{},step:0};constructor(e){super(e),this.state={isEditing:!0}}handleEmailValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validateEmail()};handleEmailFocus=()=>{this.props.onInteraction("signup","click","input-email",null,this.props.actionHash)};handlePasswordValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validatePassword()};handlePasswordFocus=()=>{this.props.onInteraction("signup","click","input-password",null,this.props.actionHash)};handleNameFocus=()=>{this.props.onInteraction("signup","click","input-name",null,this.props.actionHash)};handleGenderOptionFocus=e=>{this.props.onInteraction("signup","click",`input-gender-${e}`,null,this.props.actionHash)};handleInputChange=({target:{name:e,value:t}})=>{this.props.updateData({[e]:t}),this.setState({isEditing:!0})};handleBirthDateChange=e=>{this.props.updateData({birthDate:e})};handleSendEmailChange=e=>{this.props.updateData({sendEmail:e})};handleShareDataChange=e=>{this.props.updateData({shareData:e})};handleAgreeEulaChange=e=>{this.props.updateData({agreeEula:e})};handleSubmit=e=>{e&&e.preventDefault();const{step:t,actionHash:s}=this.props;this.props.onInteraction("signup","click",0===t?"continue":"create-account",null,s),this.setState({isEditing:!1});let n=!0;const r={0:["email","password","name"],1:["birthDate","gender","agreeEula"]};!!this.props.errors&&Object.keys(this.props.errors).filter((e=>-1!==r[t].indexOf(e))).some((e=>this.props.errors[e]&&this.props.errors[e].message))&&(n=!1);const o=e=>t=>{this.props.data[t]||(this.props.onValidate(t,{code:e}),n=!1)};switch(t){case 0:["email","password","name"].forEach(o("valueMissing"));break;case 1:{const{day:e,month:t,year:r}=this.props.data.birthDate;r||this.props.onInteraction("signup","view","show-error-empty-year",null,s),t||this.props.onInteraction("signup","view","show-error-empty-month",null,s),e||this.props.onInteraction("signup","view","show-error-empty-date",null,s);const i=us(e,t,r,this.props.restrictions.minimum_age);i&&(this.props.onValidate("birthDate",{code:i}),n=!1),o("valueMissing")("gender"),o("notAccepted")("agreeEula")}}if(n)switch(t){case 0:this.setStep(t+1);break;case 1:this.props.signup(s)}};handleBack=()=>{const{step:e}=this.props;this.props.onInteraction("signup","click",`back-step-${e+1}`,null,this.props.actionHash),this.props.clearAllErrors(),e<=0?this.props.enterWelcomeMode():this.setStep(e-1)};handleLogin=()=>{const e=wt();this.props.onInteraction("signup","click","open-page-login",null,e),this.props.enterLoginMode(e)};setStep=e=>{switch(e){case 0:this.props.enterSignupModeStep0();break;case 1:this.props.enterSignupModeStep1()}};renderErrorMsg(){const e=Object.keys(this.props.errors).filter((e=>this.props.errors[e]&&this.props.errors[e].message));return(0,St.jsx)("div",{className:"glue-hidden-visually",role:"alert","aria-live":this.state.isEditing?"off":"assertive",children:e.length>0?(0,St.jsxs)("div",{children:[(0,St.jsx)("p",{children:tt.get("desktop.login.email.errorMessageA11y",e.length)}),(0,St.jsx)("ul",{children:e.map((e=>(0,St.jsx)("li",{children:this.props.errors[e].message},e)))})]}):null})}renderStep0(){const{data:e,errors:t,isDisabled:s,onValidate:n}=this.props;return(0,St.jsxs)("div",{children:[(0,St.jsx)(ls,{name:"email",type:"email",label:tt.get("desktop.login.SignupEmail"),value:e.email,onChange:this.handleInputChange,isDisabled:s,error:t.email,onValidate:this.handleEmailValidate,onFocus:this.handleEmailFocus,isRequired:!0,autoFocus:!0,rightIcon:Zt.B}),(0,St.jsx)(ls,{name:"password",type:"password",label:tt.get("desktop.login.CreateAPassword"),value:e.password,onChange:this.handleInputChange,minLength:8,isRequired:!0,isDisabled:s,error:t.password,onValidate:this.handlePasswordValidate,onFocus:this.handlePasswordFocus,onTogglePasswordVisibility:e=>{this.props.onInteraction("signup","click",e?"toggle-password-visibility-show":"toggle-password-visibility-hide",null,this.props.actionHash)}}),(0,St.jsx)(ls,{name:"name",label:tt.get("desktop.login.SignupName"),value:e.name,onChange:this.handleInputChange,isRequired:!0,isDisabled:s,error:t.name,onValidate:n,rightIcon:Qt.W,onFocus:this.handleNameFocus})]})}renderStep1(){const{data:e,errors:t,restrictions:s,isDisabled:n,onValidate:r}=this.props;let o=null;s.requires_marketing_opt_in_text?o=(0,St.jsx)("div",{className:"SignupForm__send-email-implicit",children:tt.get("desktop.login.SendEmailImplicitLabel")}):s.requires_marketing_opt_in&&(o=(0,St.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,St.jsx)(fs,{name:"send-email",label:tt.get("desktop.login.SendEmailLabel"),onChange:this.handleSendEmailChange,isChecked:e.sendEmail,isDisabled:n})}));const i=[{label:tt.get("desktop.login.Female"),value:"female"},{label:tt.get("desktop.login.Male"),value:"male"}];return s.use_all_genders&&i.push({label:tt.get("desktop.login.NonBinary"),value:"neutral"}),s.use_other_gender&&i.push({label:tt.get("desktop.login.gender.Other"),value:"other"}),s.use_prefer_not_to_say_gender&&i.push({label:tt.get("desktop.login.gender.PreferNotToSay"),value:"prefer_not_to_say"}),(0,St.jsxs)("div",{children:[(0,St.jsx)(gs,{name:"birth-date",label:tt.get("desktop.login.WhatsYourSignupBirthDate"),value:e.birthDate,onChange:this.handleBirthDateChange,disabled:n,error:t.birthDate,onValidate:r,dateEndianness:s.date_endianness,minAge:s.minimum_age,autoFocus:!0,onFocus:()=>{this.props.onInteraction("signup","click","input-birth-date",null,this.props.actionHash)}}),(0,St.jsx)(_s,{showTitle:!0,name:"gender",label:tt.get("desktop.login.WhatsYourSignupGender"),options:i,value:e.gender,onChange:this.handleInputChange,disabled:n,error:t.gender,onValidate:r,onOptionFocus:this.handleGenderOptionFocus}),o,(0,St.jsx)(Es,{restrictions:s,error:t.agreeEula,disabled:n,onChange:this.handleAgreeEulaChange})]})}render(){const{isDisabled:e,step:t}=this.props;return(0,St.jsxs)("form",{onSubmit:this.handleSubmit,className:"SignupForm",children:[this.renderErrorMsg(),(0,St.jsx)(Ss,{}),0===t?this.renderStep0():"",1===t?this.renderStep1():"",(0,St.jsx)(vt.D,{type:"submit",disabled:e,id:"signup-button",onClick:this.handleSubmit,"data-ta-id":"signup-submit",fullWidth:!0,children:0===t?tt.get("desktop.login.Continue"):tt.get("desktop.login.SignupButton")}),0===t&&(0,St.jsxs)(bt.Fragment,{children:[(0,St.jsx)(xs,{title:tt.get("desktop.login.SignupOr")}),(0,St.jsx)(Cs,{})]}),(0,St.jsx)(es.o,{onClick:this.handleBack,children:tt.get("desktop.login.Back")}),0===t&&(0,St.jsx)("h3",{className:"FooterFormText",children:(0,St.jsx)("a",{className:"FooterFormText__NoUnderline",href:"#",id:"login-link",onClick:this.handleLogin,dangerouslySetInnerHTML:{__html:tt.get("desktop.login.AlreadyOnSpotifyLogin")}})})]})}}const Is=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions,email:e.signup.email,errors:e.signup.errors,data:e.signup.formData,actionHash:e.app.currentActionHash??wt()})),(e=>({signup:t=>e(ft.signup(t)),enterLoginMode:t=>e(ft.enterLoginMode(t)),enterSignupModeStep0:()=>e(ft.enterSignupModeStep0()),enterSignupModeStep1:()=>e(ft.enterSignupModeStep1()),updateData:t=>e(ft.updateSignupData(t)),validateEmail:()=>e(ft.validateField("email")),validatePassword:()=>e(ft.validateField("password")),enterWelcomeMode:()=>e(ft.enterWelcomeMode()),clearAllErrors:()=>e(ft.clearAllErrors()),onValidate:(t,s)=>{if(s){const n=s.code||s,r={birthDate:{incomplete:tt.get("desktop.login.birthDate.incomplete"),invalid:tt.get("desktop.login.birthDate.invalid")},password:{valueMissing:tt.get("desktop.login.password.valueMissing"),tooShort:tt.get("desktop.login.password.tooShort")},email:{valueMissing:tt.get("desktop.login.email.valueMissing"),typeMismatch:tt.get("desktop.login.email.typeMismatch")},name:{valueMissing:tt.get("desktop.login.name.valueMissing")},gender:{valueMissing:tt.get("desktop.login.gender.valueMissing")},agreeEula:{notAccepted:tt.get("desktop.login.agreeEula.notAccepted")}};e(ft.validateFieldFailure(t,{code:n,message:r[t]&&r[t][n]||""}))}else e(ft.validateFieldSuccess(t))},onInteraction:(t,s,n,r,o)=>e(ft.interaction(t,s,n,r,o))})))(Ts);class Ns extends bt.PureComponent{render(){const{step:e,restrictions:t}=this.props;if(!t)return(0,St.jsx)(yt,{delay:2e3});const s=0===e?tt.get("desktop.login.SignupHeroText"):tt.get("desktop.login.SignupAlmostDone");return(0,St.jsxs)("main",{className:"Signup","data-testid":"signup","aria-labelledby":"signup-form-title",id:"signup","data-ta-id":"signup-form",children:[(0,St.jsx)("h1",{className:"HeroText",id:"signup-form-title",children:s}),(0,St.jsx)(Is,{step:e})]})}}const As=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})))(Ns);class Ps extends bt.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(){this.props.isDisabled||this.props.onChange(!this.props.isActive)}render(){const{isActive:e,isDisabled:t,labelId:s,taId:n}=this.props;return(0,St.jsxs)("div",{className:ss()("GlueToggle",{"GlueToggle--is-active":e,"GlueToggle--is-disabled":t}),children:[(0,St.jsx)("input",{type:"checkbox",name:s,id:s,className:"glue-hidden-visually",onChange:this.handleChange,checked:e,disabled:t,"data-ta-id":n}),(0,St.jsx)("div",{className:"GlueToggle__toggle",onClick:this.handleChange,"aria-hidden":"true",children:(0,St.jsx)("div",{className:"GlueToggle__toggle-inner"})})]})}}Ps.defaultProps={isActive:!1,isDisabled:!1,onChange:()=>{}};class Ds extends bt.PureComponent{render(){const{name:e,label:t,checked:s,disabled:n,onChange:r}=this.props,o=`${e}-field`;return(0,St.jsxs)("div",{className:"FormToggle",children:[(0,St.jsx)("label",{htmlFor:o,"data-ta-id":"remember-me-label",children:t}),(0,St.jsx)(Ps,{labelId:o,isActive:s,onChange:r,taId:"remember-me-slider",isDisabled:n})]})}}class Fs extends bt.PureComponent{constructor(e){super(e),this.state={username:this.props.username,password:"",rememberMe:!0},["handleSubmit","handleUsernameChange","handleUsernameFocus","handlePasswordChange","handlePasswordFocus","handleRememberMeChange"].forEach((e=>{this[e]=this[e].bind(this)}))}handleUsernameChange({target:e}){this.setState({username:e.value})}handleUsernameFocus(){this.props.onInteraction("login","click","input-email",null,this.props.actionHash)}handlePasswordChange({target:e}){this.setState({password:e.value})}handlePasswordFocus(){this.props.onInteraction("login","click","input-password",null,this.props.actionHash)}handleRememberMeChange(){this.setState({rememberMe:!this.state.rememberMe})}handleSubmit(e){e&&e.preventDefault();const t=this.state.username?this.state.username.trim():null,{password:s,rememberMe:n}=this.state,{actionHash:r}=this.props;this.props.onInteraction("login","click","login-email",null,r),t&&s?this.props.login({username:t,password:s,rememberMe:n},!1,r):t?s||this.props.onInteraction("login","view","show-error-empty-password",null,r):this.props.onInteraction("login","view","show-error-empty-email",null,r)}handleForgotPasswordLinkClick=()=>{this.props.onInteraction("login","click","reset-password",null,this.props.actionHash)};render(){const{isDisabled:e}=this.props;return(0,St.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,St.jsx)("h3",{className:"glue-hidden-visually",children:tt.get("desktop.login.LoginWithEmailTitle")}),(0,St.jsx)(Ss,{}),(0,St.jsx)(ls,{name:"username",label:tt.get("desktop.login.LoginUsernameOrEmail"),value:this.state.username||"",onChange:this.handleUsernameChange,onFocus:this.handleUsernameFocus,isDisabled:e,autoFocus:!0,noValidate:!0,rightIcon:Zt.B}),(0,St.jsx)(ls,{name:"password",type:"password",label:tt.get("desktop.login.LoginPassword"),value:this.state.password,onChange:this.handlePasswordChange,onFocus:this.handlePasswordFocus,isDisabled:e,noValidate:!0}),(0,St.jsx)("a",{className:"LoginForm__reset-password",href:"https://www.spotify.com/redirect/password-reset",target:"_new",onClick:this.handleForgotPasswordLinkClick,children:tt.get("desktop.login.forgotPassLink")}),(0,St.jsx)(Ds,{name:"remember-me",label:tt.get("desktop.login.RememberMeLabel"),checked:this.state.rememberMe,onChange:this.handleRememberMeChange,disabled:e}),(0,St.jsx)("button",{type:"submit",className:"button button-white LoginForm__login-button",disabled:e,id:"login-button","data-ta-id":"login-button",children:tt.get("desktop.login.LoginButton")})]})}}const Ms=(0,d.$j)((e=>({isDisabled:!!e.login.loginInProgress,username:e.login.username,actionHash:e.app.currentActionHash??wt()})),(e=>({login:(t,s,n)=>e(ft.login(t,s,n)),onInteraction:(t,s,n,r,o)=>e(ft.interaction(t,s,n,r,o))})))(Fs);class Os extends bt.PureComponent{componentWillUnmount(){this.props.clearErrors()}handleSignup(){const e=wt();this.props.enterSignupMode(e),this.props.onInteraction("login","click","open-page-signup",null,e)}getSignupLink(){return(0,St.jsx)("a",{className:"FooterFormText__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignup(),"data-ta-id":"signup-link",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.DontHaveAnAccountSignup")}})}render(){const{isDisabled:e,actionHash:t}=this.props;return(0,St.jsxs)("main",{className:"Login","data-testid":"login","aria-labelledby":"login-form-title",id:"login","data-ta-id":"login-form",children:[(0,St.jsx)("h1",{className:"HeroText",id:"login-form-title",children:tt.get("desktop.login.LoginHeroText")}),(0,St.jsx)(Ms,{}),(0,St.jsx)(xs,{title:tt.get("desktop.login.SignupOr")}),(0,St.jsx)(ks,{method:"facebook",isDisabled:e,onClick:e=>this.props.onSocialButtonClick(e,t),type:"login",label:tt.get("desktop.login.ContinueWithFacebook")}),(0,St.jsx)(ks,{method:"google",isDisabled:e,onClick:e=>this.props.onSocialButtonClick(e,t),type:"login",label:tt.get("desktop.login.ContinueWithGoogle")}),(0,St.jsx)(ks,{method:"apple",isDisabled:e,onClick:e=>this.props.onSocialButtonClick(e,t),type:"login",label:tt.get("desktop.login.ContinueWithApple")}),(0,St.jsx)("h3",{className:"FooterFormText",children:this.getSignupLink()})]})}}const Ls=(0,d.$j)((e=>({isDisabled:!!e.login.loginInProgress,actionHash:e.app.currentActionHash??wt()})),(e=>({enterSignupMode:t=>e(ft.enterSignupMode(t)),onInteraction:(t,s,n,r,o)=>e(ft.interaction(t,s,n,r,o)),onSocialButtonClick:(t,s)=>{e(ft.loginWithAccounts(t,s)),e(ft.interaction("login","click",`login-${t}`,null,s))},clearErrors:()=>e(ft.loginClearErrors())})),((e,t)=>({...e,...t,onSocialButtonClick:(e,s)=>{t.onSocialButtonClick(e,s)}})))(Os);class js extends bt.PureComponent{render(){const{operationUsed:e}=this.props,t="signup"===e?tt.get("desktop-auth.login.redirecting-to-browser-signup"):tt.get("desktop-auth.login.redirecting-to-browser-login");return(0,St.jsx)("main",{children:(0,St.jsx)("h1",{className:"HeroText __redirect",children:t})})}}const Rs=(0,d.$j)((e=>({operationUsed:e.experimentWebAuthReducer.operationUsed})))(js);var Us=s(5287);const Gs="mpdBa62OP4Fr5wvCsa89",Bs="acVhMt5pELcXQyLaaPuV",Hs="AavUTirpKSAHapguSAy0",Ws="SkbGMKYv49KtJNB5XxdX",Vs="qfjicQPaTTPrLWJWRxMQ",$s=({id:e,type:t,placeHolder:s,inputRef:n,handleOnChange:r})=>(0,St.jsx)("input",{type:t||"text",id:e,"data-testid":e,className:Ws,placeholder:s,ref:n,onChange:r}),Ks=({children:e,label:t})=>(0,St.jsx)(Us.c,{label:t,className:Vs,children:e});var Ys=s(2842),qs=s.n(Ys);const zs="zrvvPyoxE6wQNqnu0yWA",Js="jmu6DFPvhxRl0wSfmv2O",Xs=({value:e,id:t,children:s,disabled:n,onSelect:r,className:o,dir:i})=>(0,St.jsx)("span",{className:o,children:(0,St.jsx)("select",{className:ss()(zs,{[Js]:"Safari"===qs().parse(window.navigator.userAgent).browser.name}),value:e?.toString(),id:t,disabled:n,onBlur:()=>{},onChange:e=>{r(e.target.value)},dir:i,children:s})}),Zs=(0,bt.createContext)(void 0),Qs=({children:e})=>{const[t,s]=(0,bt.useState)(!1),[n,r]=(0,bt.useState)(new Set),o=(0,bt.useCallback)(((e,t)=>{r((s=>{if(s.has(e)===t)return s;const n=new Set(s);return t?n.add(e):n.delete(e),n}))}),[]),i=n.size>0;return(0,St.jsx)(Zs.Provider,{value:{sectionMatch:t,setSectionMatch:s,sectionContainsMatch:i,setSectionFilterMatchQueryValue:o},children:e})};(0,s(7910).Ue)((e=>({lastFilterState:"",lastFilteredUri:"",setLastState:(t,s)=>{e({lastFilterState:t,lastFilteredUri:s})}})));const en=(0,bt.createContext)({setFilter:()=>{throw new Error("setFilter must be used within a FilterProvider")},filter:""});s(8123);let tn;!function(e){e.UPDATE="update"}(tn||(tn={}));const sn=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"}),nn=/\p{White_Space}/u,rn=/\p{P}/u,on=/\p{sc=Han}/u;function an(e){return null!==e&&nn.test(e)}function ln(e){return null!==e&&(e<="/"||e>=":"&&e<="@"||"\\"===e||an(e))}function dn(e){return null!==e&&rn.test(e)}function cn(e){return null!==e&&on.test(e)}class un{constructor(e,t,s){if(t<0||s<0||t+s>e.length)throw new RangeError;this.data=e,this.offset=t,this.length=s,this.position=0}static from(e){const t=Array.from(e.normalize("NFC"));return new un(t,0,t.length)}toString(){return this.data.slice(this.offset,this.offset+this.length).join("")}slice(e=0,t=this.length){if(e<0||t>this.length)throw new RangeError;const s=this.offset+e,n=t-e;return new un(this.data,s,n)}nextCodePoint(){return this.position===this.length?null:this.data[this.offset+this.position++]}}function pn(e){let t;do{t=e.nextCodePoint()}while(null!==t&&an(t)||dn(t));return t}function hn(e,t){let s=pn(e),n=pn(t);if(null===n)return{offset:0,length:0};const r=e.offset+e.position-1;let o=e.offset+e.position;for(;;){if(null===s&&null===n)return{offset:r,length:o-r};if(null===n)return{offset:r,length:o-r};if(null===s)return null;if(0!==sn.compare(s,n))return null;o=e.offset+e.position,s=pn(e),n=pn(t)}}function gn(e,t){let s,n,r;do{n=e.position,s=e.nextCodePoint()}while(null!==s&&an(s));if(t?.segmentQuotedStrings&&function(e){return null!==e&&('"'===e||"'"===e)}(s)){const t=s;n=e.position;do{r=e.position,s=e.nextCodePoint()}while(null!==s&&s!==t);return null===s&&n===r?null:e.slice(n,r)}do{if(r=e.position,t?.segmentCJKUnifieIdeographs&&cn(s))break;s=e.nextCodePoint()}while(null!==s&&!ln(s));return null===s&&n===r?null:e.slice(n,r)}function mn(e){return gn(e,{segmentQuotedStrings:!0,segmentCJKUnifieIdeographs:!1})}function _n(e){return gn(e,{segmentQuotedStrings:!1,segmentCJKUnifieIdeographs:!0})}function fn(e,t){const s=[];for(let n=_n(e);null!==n;n=_n(e)){let r=hn(n,t.slice());null===r?(r=hn(e.slice(n.offset),t.slice()),null===r||s.push(r)):s.push(r)}return s}function bn(e,t){return e.offset===t.offset&&e.length===t.length}const Sn=(e,t)=>"string"==typeof e&&"string"==typeof t?!(e.length>0)||null!==function(e,...t){const s=un.from(e),n=[];for(let e=mn(s);null!==e;e=mn(s)){const s=[];for(let n=0;n<t.length;++n){const r=t[n],o=fn(un.from(r),e);for(const e of o)s.push({text:r,range:e})}if(0===s.length)return null;n.push(...s.filter(((e,t,s)=>e.range.length>0&&s.findIndex((t=>bn(e.range,t.range)))===t)))}return n.length>0?n:null}(e,t):"boolean"!=typeof e||e,yn="c6TyNYOUJRIsjYZJZofy";function En({children:e,filterMatchQuery:t}){const{filter:s}=(0,bt.useContext)(en),{setSectionMatch:n,sectionContainsMatch:r}=(()=>{const e=(0,bt.useContext)(Zs);if(void 0===e)throw new Error("useSectionMatchState() must be used within a SectionFilterMatchContextProvider");return e})(),o=Sn(s,t);return(0,bt.useEffect)((()=>{n(o)}),[o,n]),o||r?(0,St.jsx)("div",{className:yn,children:e}):null}function kn(e){return(0,St.jsx)(Qs,{children:(0,St.jsx)(En,{...e})})}var wn=s(9237),Cn=s.n(wn);const vn="M0E2Al6URHV3iyoDbvi_";function xn({searchWords:e,textToHighlight:t,...s}){return 0===e.length||e.every((e=>!e))?(0,St.jsx)(St.Fragment,{children:t}):(0,St.jsx)(Cn(),{highlightClassName:vn,searchWords:e,textToHighlight:t,autoEscape:!0,...s})}function Tn({children:e}){const{filter:t}=(0,bt.useContext)(en);return(0,St.jsx)(It.D,{as:"h2",variant:"cello",semanticColor:"textBase",children:(0,St.jsx)(xn,{searchWords:[t],textToHighlight:e})})}var In=s(1677);const Nn="gvcgOXnAiNKEe_z92_lw";function An({onClick:e}){return(0,St.jsx)(In.P,{className:Nn,onClick:e,children:tt.get("settings.restartApp")})}const Pn=(e,t,s)=>{let n=`${e}:${t}`;switch(s){case st:n+="@http";break;case nt:n+="@socks4";break;case rt:n+="@socks5"}return n},Dn=({addr:e,mode:t,pass:s,user:n,setValue:r,restartContainer:o,fullWidth:i})=>{const a=(0,bt.useRef)(null),l=(0,bt.useRef)(null),d=(0,bt.useRef)(null),c=(0,bt.useRef)(null),[u,p]=(0,bt.useState)(""),[h,g]=(0,bt.useState)(""),[m,_]=(0,bt.useState)(!1);(0,bt.useEffect)((()=>{const[t,s]=e?.split(/[:@]+/)||["",""];p(t),g(s),a.current&&(a.current.value=t),l.current&&(l.current.value=s)}),[e]),(0,bt.useEffect)((()=>{c.current&&s&&(c.current.value=s.toString())}),[s]),(0,bt.useEffect)((()=>{d.current&&n&&(d.current.value=n.toString())}),[n]);const f=(0,bt.useCallback)((({target:e})=>{const s=Pn(e.value,h,t||0);p(e.value),r("network.proxy.addr",s),_(!0)}),[t,h,r]),b=(0,bt.useCallback)((({target:e})=>{const s=Pn(u,e.value,t||0);g(e.value),r("network.proxy.addr",s),_(!0)}),[t,u,r]),S=(0,bt.useCallback)((({target:e})=>{r("network.proxy.user",e.value),_(!0)}),[r]),y=(0,bt.useCallback)((({target:e})=>{r("network.proxy.pass",e.value),_(!0)}),[r]),E=0!==t&&1!==t,k=t!==nt;return(0,St.jsxs)(kn,{filterMatchQuery:tt.get("desktop.settings.proxy.title"),children:[(0,St.jsx)(Tn,{children:tt.get("desktop.settings.proxy.title")}),(0,St.jsxs)("div",{className:ss()(Bs,i?Hs:null),children:[(0,St.jsx)(Ks,{label:tt.get("desktop.settings.proxy.type"),children:(0,St.jsx)(Xs,{id:"network.proxy.mode",value:t,onSelect:e=>{const t=parseInt(e,10);r("network.proxy.mode",t),_(!0)},children:it.map((({enumKey:e,enumValue:t})=>(0,St.jsx)("option",{value:t,"data-testid":e,children:ot[e]?ot[e].label():""},e)))})}),E?(0,St.jsxs)(St.Fragment,{children:[(0,St.jsxs)("div",{className:Gs,children:[(0,St.jsx)(Ks,{label:tt.get("desktop.settings.proxy.host"),children:(0,St.jsx)($s,{id:"network.proxy.host",handleOnChange:f,placeHolder:tt.get("desktop.settings.proxy.host"),inputRef:a})}),(0,St.jsx)(Ks,{label:tt.get("desktop.settings.proxy.port"),children:(0,St.jsx)($s,{id:"network.proxy.port",type:"number",handleOnChange:b,placeHolder:tt.get("desktop.settings.proxy.port"),inputRef:l})})]}),(0,St.jsxs)("div",{className:k?Gs:void 0,children:[(0,St.jsx)(Ks,{label:tt.get("desktop.settings.proxy.user"),children:(0,St.jsx)($s,{id:"network.proxy.user",handleOnChange:S,placeHolder:tt.get("desktop.settings.proxy.user"),inputRef:d})}),k?(0,St.jsx)(Ks,{label:tt.get("desktop.settings.proxy.pass"),children:(0,St.jsx)($s,{id:"network.proxy.pass",handleOnChange:y,placeHolder:tt.get("desktop.settings.proxy.pass"),type:"password",inputRef:c})}):null]})]}):null,m&&(0,St.jsx)("div",{children:(0,St.jsx)(An,{onClick:o})})]})]})},Fn=["network.proxy.mode","network.proxy.addr","network.proxy.user","network.proxy.pass"];const Mn=(0,d.$j)((e=>({settings:{proxy:e.settings.proxy}})),(e=>({fetchProxySettings(){e(ft.fetchProxySettings())},updateProxySettings(t){e(ft.updateProxySettings(t))},restartClient(){e(ft.restartClient())}})))((({settings:e={proxy:{mode:0,address:"",username:"",password:""}},fetchProxySettings:t=(()=>{}),updateProxySettings:s=(()=>{}),restartClient:n=(()=>{})})=>{(0,bt.useEffect)((()=>{t()}),[t]);const r=(0,bt.useCallback)(((t,n)=>{if(function(e){return!!Fn.includes(e)}(t)){const r={...e.proxy};switch(t){case"network.proxy.mode":r.mode=n;break;case"network.proxy.addr":r.address=n;break;case"network.proxy.user":r.username=n;break;case"network.proxy.pass":r.password=n}s(r)}return Promise.resolve()}),[e,s]);return(0,St.jsxs)("main",{className:"Settings","aria-labelledby":"settings-form-title","data-testid":"settings",children:[(0,St.jsx)("h1",{className:"HeroText",id:"settings-form-title",children:tt.get("desktop.login.PreferencesLink")}),(0,St.jsx)(Dn,{mode:e.proxy.mode,addr:e.proxy.address,user:e.proxy.username,pass:e.proxy.password,setValue:r,restartContainer:n,fullWidth:!0})]})}));class On extends bt.PureComponent{constructor(e){super(e),this.handleSettingsClick=this.goToSettingsPage.bind(this),this.handleBackToLoginClick=this.handleBackToLoginClick.bind(this)}handleSignupClick(){const{openSignupPage:e,onInteraction:t}=this.props,s=wt();e(s),t("login/welcome","click","open-page-signup",null,s)}handleBackToLoginClick(e){e.preventDefault(),this.props.openLoginPage(),this.props.onInteraction(this.props.mode,"click","back-to-login")}goToSettingsPage(e){e.preventDefault(),this.props.openSettingsPage(),this.props.onInteraction(this.props.mode,"click","open-page-settings")}renderPreferencesLink(){return(0,St.jsx)("a",{className:"Footer__link",href:"#",onClick:this.handleSettingsClick,"data-ta-id":"login-footer-settings",children:tt.get("desktop.login.PreferencesLink")})}renderBackToLoginLink(){return(0,St.jsx)("a",{className:"Footer__link",href:"#",onClick:this.handleBackToLoginClick,"data-ta-id":"login-footer-settings-back-to-login",children:tt.get("desktop.login.Back")})}renderTryAgain(){return(0,St.jsxs)(St.Fragment,{children:[(0,St.jsx)("span",{children:tt.get("desktop-auth.login.not-seeing-browser")})," ",(0,St.jsx)("a",{href:"#",onClick:()=>this.props.tryAgainHandler(),children:tt.get("desktop-auth.login.try-again")})]})}renderSignupLink(){return(0,St.jsx)("a",{className:"Footer__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignupClick(),"data-ta-id":"welcome-signup-link",dangerouslySetInnerHTML:{__html:tt.get("desktop.login.DontHaveAnAccountSignup")}})}renderRussiaLegalFormLink(){return(0,St.jsx)("div",{children:(0,St.jsx)("a",{className:"Footer__link",href:"https://support.spotify.com/ru-ru/contact-spotify-legal-form/",target:"_blank",rel:"noopener",children:"Форма для Ваших обращений"})})}renderMode(e,t){return"login"===e||"welcome"===e&&t?this.renderPreferencesLink():"settings"===e?this.renderBackToLoginLink():"open-browser"===e?this.renderTryAgain():"welcome"===e?this.renderSignupLink():null}render(){const{mode:e,country:t,isAuthOnWebEnabled:s}=this.props;return(0,St.jsxs)("footer",{className:"Footer",role:"contentinfo",children:[this.renderMode(e,s),"RU"===t&&this.renderRussiaLegalFormLink()]})}}const Ln=(0,d.$j)((e=>({country:e.signup.restrictions?.country})),(e=>({tryAgainHandler:()=>{e(ft.abortLoginWithAccounts()),e(ft.enterWelcomeMode())},openLoginPage:()=>{e(ft.enterLoginMode())},openSignupPage:t=>e(ft.enterSignupMode(t)),openSettingsPage:()=>e(ft.enterSettingsMode()),onInteraction:(t,s,n,r,o)=>e(ft.interaction(t,s,n,r,o))})))(On);class jn extends bt.PureComponent{render(){return(0,St.jsxs)("header",{className:"Header",children:[(0,St.jsx)("h1",{className:"glue-hidden-visually",children:"Spotify"}),(0,St.jsx)("img",{className:"Header__logo",src:"images/logo.svg",alt:""})]})}}var Rn=s(1141),Un=s(5879),Gn=s(3016);const Bn=(0,s(6216).JP)({name:"enableAuthOnWeb",description:"Property to enable experiment to use the web authentication flow for Desktop application.",default:!1});class Hn extends bt.Component{static defaultProps={throbberDelay:0,transitionLeaveTimeout:0};renderFakeWebPlayer(){return(0,St.jsxs)("div",{className:"fakeWebPlayer",children:[(0,St.jsx)("aside",{}),(0,St.jsxs)("footer",{children:[(0,St.jsx)("div",{className:"fakeWebPlayer__footer-left"}),(0,St.jsx)("div",{className:"fakeWebPlayer__footer-center"}),(0,St.jsx)("div",{className:"fakeWebPlayer__footer-right"})]}),(0,St.jsx)("main",{children:(0,St.jsx)("div",{className:"fakeWebPlayer__content"})})]})}renderMode(e,t,s,n){return"settings"===e?(0,St.jsx)(Mn,{}):s?(0,St.jsx)(Xt,{eventSender:n}):"welcome"===e?(0,St.jsx)(Tt,{}):"signup"===e?(0,St.jsx)(As,{step:t}):"login"===e?(0,St.jsx)(Ls,{}):"open-browser"===e?(0,St.jsx)(Rs,{}):null}render(){const{loading:e,mode:t,loggedIn:s,previousMode:n,throbberDelay:r,signupStep:o,previousSignupStep:i,isAuthOnWebEnabled:a,eventSender:l}=this.props;if(e||!t)return(0,St.jsx)(yt,{delay:r});if(s)return null;let d=n?`__${t} __${n}-to-${t}`:"";return"signup"===t&&Number.isInteger(i)&&(d+=` __signup_step_${i}_to_${o}`),(0,St.jsxs)("main",{className:"App","data-ta-id":"login-app","data-testid":"login-app","data-ta-login-mode":t,children:[this.renderFakeWebPlayer(),(0,St.jsx)("div",{className:`App__content ${d}`,children:(0,St.jsx)(Un.Z,{mode:"in-out",children:(0,St.jsx)(Rn.Z,{timeout:{appear:0,enter:0,exit:650},children:(0,St.jsxs)("div",{className:`App__modal ${d}`,children:[(0,St.jsx)(jn,{}),this.renderMode(t,o,a,l),(0,St.jsx)(Ln,{mode:t,isAuthOnWebEnabled:a})]})},d)})})]},"main1")}}const Wn=(0,Gn.yS)({isAuthOnWebEnabled:Bn}),Vn=(0,d.$j)((e=>({mode:e.app.mode,previousMode:e.app.previousMode,signupStep:e.signup.step,previousSignupStep:e.signup.previousStep,loading:!!e.login.loading,loggedIn:!!e.login.loggedIn,throbberDelay:e.login.throbberDelay,transitionLeaveTimeout:e.login.redirectDelay})))(Wn(Hn));var $n=s(4385),Kn=s(874);const Yn=e=>t=>s=>{const n=t(s);switch(s.type){case ft.START_APP:!async function(){new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"POST",uri:"sp://messages/v1/container/control",body:'{"type":"view_loaded", "name":"/loginUI"}'}),persistent:!1,onSuccess:()=>{e()},onFailure:(e,s)=>{t(e)}})}))}(),e.dispatch(ft.getSignupRestrictions());!h.getItem("lastUsername")?e.dispatch(ft.enterWelcomeMode()):e.dispatch(ft.enterLoginMode());break;case ft.LOGIN_FAIL:{const t=e.getState();if(s.loginType===ft.LOGIN_TYPE_AUTOLOGIN){const s=t.app.mode;"welcome"===s?e.dispatch(ft.enterWelcomeMode()):"login"===s?e.dispatch(ft.enterLoginMode()):"signup"===s&&e.dispatch(ft.enterSignupMode())}else{if("open-browser"===t.app.mode){const n=s.errorData;let r=jt(n.errorCategory,n.errorCode,n.errorReference);"desktop_login_accounts"===n.errorCategory&&4===n.errorCode&&(r="signup"===t.experimentWebAuthReducer.operationUsed?tt.get("desktop-auth.login.signup-time-out"):tt.get("desktop-auth.login.login-time-out")),r?e.dispatch(ft.enterWelcomeMode(r)):e.dispatch(ft.enterWelcomeMode())}}break}case ft.ENTER_SIGNUP_MODE:{const t=e.getState().signup.restrictions;t?!1===t.is_country_launched&&e.dispatch(ft.countryNotLaunched()):e.dispatch(ft.getSignupRestrictions());break}case ft.SIGNUP_RESTRICTIONS_SUCCESS:!1===s.restrictions.is_country_launched&&e.dispatch(ft.countryNotLaunched());break;case ft.SIGNUP_FAILURE:(s.errors.email||s.errors.password||s.errors.displayname)&&e.dispatch(ft.enterSignupModeStep0());break;case ft.COUNTRY_NOT_LAUNCHED:e.dispatch(ft.openSignupPage(!0))}return n},qn=e=>{window.location.href=e},zn=()=>e=>t=>{const s=e(t);if(!t.redirectTo)return s;let n;return"xpui"!==t.redirectTo||(n="spotify:app:xpui",t.redirectDelay?setTimeout((()=>{qn(n)}),t.redirectDelay):qn(n)),s},Jn={errorMessage:null,currentActionHash:null};const Xn=function(e=Jn,t){switch(t.type){case ft.ENTER_SIGNUP_MODE:return{...e,previousMode:e.mode,mode:"signup",currentActionHash:t.actionHash};case ft.ENTER_LOGIN_MODE:return{...e,previousMode:e.mode,mode:"login",currentActionHash:t.actionHash};case ft.LOGIN_BEFORE:case ft.SIGNUP_ATTEMPT:case ft.FACEBOOK_SIGNUP_ATTEMPT:return{...e,currentActionHash:null};case ft.COUNTRY_NOT_LAUNCHED:return{...e,previousMode:e.mode,mode:"login"};case ft.ENTER_WELCOME_MODE:return{...e,previousMode:e.mode,mode:"welcome",errorMessage:t.errorMessage??null};case ft.ENTER_SETTINGS_MODE:return{...e,previousMode:e.mode,mode:"settings"};default:return e}};const Zn={proxy:{mode:0,address:"",username:"",password:""}};const Qn=function(e=Zn,t){return function(e){return e.type===ft.SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS}(t)?{...e,proxy:{mode:t.data.mode,address:t.data.address,username:t.data.username,password:t.data.password}}:e},er={step:0,isAttempting:!1,isSuccessful:void 0,errors:{},errorData:{},validated:{},formData:{name:"",email:"",password:"",birthDate:{day:void 0,month:void 0,year:void 0},gender:void 0,sendEmail:void 0,shareData:void 0,agreeEula:!1},restrictions:void 0};const tr=function(e=er,t){switch(t.type){case ft.ENTER_SIGNUP_MODE_STEP_0:return{...e,previousStep:e.step,step:0};case ft.ENTER_SIGNUP_MODE_STEP_1:return{...e,previousStep:e.step,step:1};case ft.SIGNUP_RESTRICTIONS_SUCCESS:return{...e,formData:{...e.formData,sendEmail:!!t.restrictions.requires_marketing_opt_in_text||void 0,agreeEula:!!t.restrictions.pretick_eula},restrictions:t.restrictions};case ft.SIGNUP_RESTRICTIONS_FAILURE:return{...e,errorData:t.error};case ft.SIGNUP_ATTEMPT:return{...e,isAttempting:!0,errorData:null};case ft.SIGNUP_SUCCESS:return{...e,isAttempting:!0,isSuccessful:!0,errorData:null};case ft.SIGNUP_FAILURE:return{...e,isAttempting:!1,isSuccessful:!1,errors:t.errors,errorData:null};case ft.FACEBOOK_SIGNUP_ATTEMPT:return{...e,errorData:null,errors:{}};case ft.FACEBOOK_SIGNUP_FAILURE:return{...e,errorData:t.errorData};case ft.VALIDATE_FIELD_ATTEMPT:return{...e,errors:{...e.errors,[t.field]:void 0}};case ft.VALIDATE_FIELD_FAILURE:return{...e,errors:{...e.errors,[t.field]:t.error},validated:{...e.validated,[t.field]:!1}};case ft.VALIDATE_FIELD_SUCCESS:return{...e,errors:{...e.errors,[t.field]:void 0},validated:{...e.validated,[t.field]:!0}};case ft.UPDATE_SIGNUP_DATA:{const s={};for(const e of Object.keys(t.data))s[e]=void 0;return{...e,errors:{...e.errors,...s},formData:{...e.formData,...t.data}}}case ft.CLEAR_ALL_ERRORS:return{...e,errors:{}};default:return e}};function sr(e){const t=(0,$n.MT)((0,$n.UY)({app:Xn,login:y,settings:Qn,signup:tr}),void 0,(0,$n.md)(Kn.Z,Yn,(e=>{const t=new zt(e);return()=>e=>s=>{const n=e(s);switch(s.type){case ft.ENTER_LOGIN_MODE:t.logPageView({page:"login"});break;case ft.LOGIN_SUCCESS:s.loginType===ft.LOGIN_TYPE_EMAIL&&t.logAction({page:"login",action_type:"view",action_intent:"show-success-login-email"});break;case ft.LOGIN_FAIL:s.loginType===ft.LOGIN_TYPE_EMAIL&&s.errorData&&3===s.errorData.errorCode&&t.logAction({page:"login",action_type:"view",action_intent:"show-error-invalid-credential"});break;case ft.ENTER_SIGNUP_MODE:t.logPageView({page:"signup"});break;case ft.ENTER_SIGNUP_MODE_STEP_0:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-one"});break;case ft.ENTER_SIGNUP_MODE_STEP_1:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-two"});break;case ft.SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-signup-email"});break;case ft.SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-signup-email",item_id:s.errors&&Object.keys(s.errors).join("|")});break;case ft.FACEBOOK_SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-authentication-facebook"});break;case ft.FACEBOOK_SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-authentication-facebook",item_id:s.errorData&&`${s.errorData.errorCode} - ${s.errorData.errorDescription}`});break;case ft.ENTER_WELCOME_MODE:t.logPageView({page:"login/welcome"});break;case ft.ENTER_SETTINGS_MODE:t.logPageView({page:"login/settings"});break;case ft.INTERACTION:t.logAction({page:s.page,action_type:s.interactionType,action_intent:s.intent,item_id:s.itemId,action_hash:s.actionHash});break;case ft.VALIDATE_FIELD_FAILURE:if(s.error){const e=s.field,n=s.error.code;let r=null,o=null;"valueMissing"===n?r=`show-error-empty-${e}`:["incomplete","invalid","typeMismatch","tooShort"].includes(n)?r=`show-error-format-${e}`:(r=`show-error-${e}`,o=s.error.message||""),null!==r&&t.logAction({page:"signup",action_type:"view",action_intent:r,...o?{item_id:o}:{}})}}return n}})(e),zn));return t.subscribe((()=>{const e=t.getState();e.login.username&&localStorage.setItem(g,e.login.username),e.login.utmParameters&&localStorage.setItem(_,JSON.stringify(e.login.utmParameters))})),t}var nr=s(2228),rr=s(2176);let or=null;var ir=s(2133),ar=s(2645);const lr=(e,t)=>{const s=e.event_sender_context_information;return[(0,ar.UY)({version_code:s.client_version_int,version_string:s.client_version_string}),(0,ar.jx)(t),(0,ar.IE)(s.installation_id),(0,ar.CF)({device_id:s.device_id,device_manufacturer:s.device_manufacturer,device_model:s.device_model,os_version:s.os_version,platform_type:s.platform_type})]},dr=/Spotify\/(?<version>.+)\s/;var cr=s(7660),ur=s(9284),pr=s(4070);(0,cr.hb)(),async function(){for(const e of[window.__spotify.locale,ze.en])try{const t=await fetch(`i18n/${e}.json`).then((e=>e.json()));return tt.setLocale(e),void tt.setDictionary(t)}catch(e){0}throw new Error("Cannot find a suitable locale! Something is wrong: talk to #desktop.")}().then((async function(){const e=function(){const e=(0,rr.qy)({providers:{endpoints:(0,rr.uG)(),token:()=>null}});return e.connect(),e}();or=e;const t=((e,t,s)=>(0,ir.mi)({transport:t,suppressPersist:!1,context:lr(e,s)}))(window.__spotify,e,"65b708073fc0480ea92a077233ca87bd"),s=sr(t);u.attach(),u.update(),c.attach();const n=document.location.search,r=new RegExp(`\\?param=error-code\\${encodeURIComponent("=")}([0-9]+)`,"i");window.addEventListener("message",(e=>{"critical-update-error"===e.data&&s.dispatch(ft.loginFailed({errorCode:e.data}))}));const o=n.match(r);if(n&&o){const e=+o[1];s.dispatch(ft.loginFailed({errorCode:e}))}let i="linux";window.navigator.platform.startsWith("Mac")&&(i="mac"),window.navigator.platform.startsWith("Win")&&(i="windows"),document.body.classList.add(`body-container--${i}`);const p=ur.L.addMiddleware(pr._);a.render((0,St.jsx)(l.zj,{children:(0,St.jsx)(d.zt,{store:s,children:(0,St.jsx)(Gn.nD,{resolver:p,context:{username:null},options:{clientId:"client-desktop-ui-app-login",timeout:5e3,transport:e,eventSender:t,version:window.navigator.userAgent.match(dr).groups.version,installationId:window.__spotify.event_sender_context_information?.installation_id},children:(0,St.jsx)(bt.Suspense,{fallback:null,children:(0,St.jsx)(Vn,{eventSender:t})})})})}),document.getElementById("main")),s.dispatch(ft.startApp()),document.documentElement.setAttribute("dir",window.__spotify.localization_is_rtl?"rtl":"ltr");const h={[nr.PLATFORM_UNKNOWN]:"body-container--unknown-os",[nr.PLATFORM_MAC]:"body-container--mac",[nr.PLATFORM_WINDOWS]:"body-container--windows"},g=(0,nr.getPlatform)();document.body.classList.add(h[g]),(0,cr.wm)("UI init phase is done for login")}))},2228:(e,t,s)=>{"use strict";s.r(t),s.d(t,{PLATFORM_MAC:()=>r,PLATFORM_UNKNOWN:()=>n,PLATFORM_WINDOWS:()=>o,getPlatform:()=>l,isMac:()=>i,isWindows:()=>a});const n=Symbol("PLATFORM_UNKNOWN"),r=Symbol("PLATFORM_MAC"),o=Symbol("PLATFORM_WINDOWS");function i(){return window.navigator.platform.startsWith("Mac")}function a(){return window.navigator.platform.startsWith("Win")}function l(){return i()?r:a()?o:n}},9663:(e,t)=>{let s=!1;t.update=()=>{},t.attach=()=>{if(s)return;s=!0;const e=window.__spotify&&window.__spotify.locale;e&&document.documentElement.setAttribute("lang",e)},t.detach=()=>{s&&(s=!1,document.documentElement.removeAttribute("lang"))}},3688:(e,t,s)=>{const{getPlatform:n,PLATFORM_UNKNOWN:r,PLATFORM_MAC:o,PLATFORM_WINDOWS:i}=s(2228);let a=!1,l="always-visible",d=0;const c={[r]:"linux",[o]:"mac",[i]:"windows"};let u=c[r];function p(){const e=[...document.querySelectorAll("*")],t=[],s=["scroll","auto","overlay"];e.forEach((e=>{const n=window.getComputedStyle(e),r=n.overflowX,o=n.overflowY;s.includes(r)&&t.push({node:e,property:"overflow-x"}),s.includes(o)&&t.push({node:e,property:"overflow-y"})}));const n=document.createElement("style");n.innerHTML="\n    html::-webkit-scrollbar,\n    body::-webkit-scrollbar {\n      background-color: rgba(1, 2, 3, 0) !important;\n    }\n  ".trimRight();const r=`data-scrollbar-fix-${++d}-id`;let o=0;t.forEach((({node:e,property:t})=>{if(e!==document.body){const s=++o;e.setAttribute(r,s),n.innerHTML+=`\n    [${r}="${s}"] { ${t}: hidden !important; }`}})),document.head.appendChild(n),setTimeout((()=>{document.head.removeChild(n),t.forEach((({node:e})=>{e.removeAttribute(r)}))}),0)}t.performScrollBarFix=p,t.update=function(){},t.attach=function(){if(a)return;a=!0;const e=window.__spotify&&window.__spotify.scroller_style;l="overlay"===e?"overlay":"always-visible";const t=n();u=c[t],"always-visible"===l||"mac"!==u?(document.body.classList.remove("scrollbar-style-when-scrolling-mac"),document.body.classList.add(`scrollbar-style-visible-${u}`)):(document.body.classList.remove(`scrollbar-style-visible-${u}`),document.body.classList.add("scrollbar-style-when-scrolling-mac")),window.addEventListener("message",(e=>{"set_active"===e.data.name&&e.data.active&&p()}))},t.detach=function(){a&&(a=!1,d=0)}}},s={};function n(e){var r=s[e];if(void 0!==r)return r.exports;var o=s[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=t,n.amdO={},e=[],n.O=(t,s,r,o)=>{if(!s){var i=1/0;for(c=0;c<e.length;c++){for(var[s,r,o]=e[c],a=!0,l=0;l<s.length;l++)(!1&o||i>=o)&&Object.keys(n.O).every((e=>n.O[e](s[l])))?s.splice(l--,1):(a=!1,o<i&&(i=o));if(a){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,r,o]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={535:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var r,o,[i,a,l]=s,d=0;if(i.some((t=>0!==e[t]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)var c=l(n)}for(t&&t(s);d<i.length;d++)o=i[d],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(c)},s=("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),n.nc=void 0;var r=n.O(void 0,[569],(()=>n(8808)));r=n.O(r)})();
//# sourceMappingURL=login.js.map